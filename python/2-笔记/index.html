<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		2-笔记 | 
	 
	hi
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

	
	

<meta name="generator" content="Hexo 7.0.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">hi</a>

	<ul id="menu">
    

    

    

    
      
      
        <li class="menu-item">
          <a href='' class="menu-item-link" target="_blank">
            
          </a>
        </li>
      
    
  
    
      <li class="menu-item">
        <a href='https://github.com/wuliurong' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Spark
									</a>
									
							<ul>
								<li class="file">
									<a href="/Spark/1-spark%E8%BD%AF%E4%BB%B6%E6%A0%88/">
                     
										    1-spark软件栈
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/centos%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    centos搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E4%BD%BF%E7%94%A8/">
                     
										    rdd使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E7%AC%94%E8%AE%B0/">
                     
										    rdd笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/scala%E5%9F%BA%E7%A1%80/">
                     
										    scala基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/spark%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    spark学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/spark%E6%BA%90%E7%A0%81%E5%9F%BA%E7%A1%80/">
                     
										    spark源码基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/windows%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    windows搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E4%BD%BF%E7%94%A8IDEA%E5%9C%A8Maven%E4%B8%AD%E5%88%9B%E5%BB%BAjava%E5%92%8Cscala%E9%A1%B9%E7%9B%AE/">
                     
										    使用IDEA在Maven中创建java和scala项目
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0%E4%B8%8E%E5%AE%9E%E9%AA%8C/">
                     
										    课堂笔记与实验
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hadoop
									</a>
									
							<ul>
								<li class="file">
									<a href="/hadoop/0.%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/">
                     
										    0.基本配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/1.Hadoop%E6%90%AD%E5%BB%BA%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%A8%A1%E5%BC%8F%E7%8E%AF%E5%A2%83/">
                     
										    1.Hadoop搭建伪分布式模式环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/10.%E8%BF%90%E8%90%A5%E5%95%86%E5%85%B3%E4%BA%8E%E7%94%A8%E6%88%B7%E5%9F%BA%E7%AB%99%E5%81%9C%E7%95%99%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/">
                     
										    10.运营商关于用户基站停留数据统计
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/11.Sqoop%E5%BA%94%E7%94%A8/">
                     
										    11.Sqoop应用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/2.%E9%80%9A%E8%BF%87shell%E5%91%BD%E4%BB%A4%E8%AE%BF%E9%97%AEHDFS/">
                     
										    2.通过shell命令访问HDFS
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/3.%E9%80%9A%E8%BF%87API%E8%AE%BF%E9%97%AEHDFS/">
                     
										    3.通过API访问HDFS
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/4.%E5%88%86%E6%9E%90%E7%BC%96%E5%86%99WordCount%E7%A8%8B%E5%BA%8F/">
                     
										    4.分析编写WordCount程序
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/5.Mapreduce%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%88%86%E5%8C%BA/">
                     
										    5.Mapreduce序列化和分区
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/6.MapReduce%E5%AE%9E%E9%AA%8Csales/">
                     
										    6.MapReduce实验sales
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/7.hive%E5%AE%9E%E9%AA%8C/">
                     
										    7.hive实验
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/8.%E6%90%9C%E7%8B%97%E6%97%A5%E5%BF%97%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90MapReduce+hive/">
                     
										    8.搜狗日志查询分析MapReduce+hive
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/9.%E5%9F%BA%E4%BA%8EHBase%E7%9A%84MapReduce%E8%AE%A1%E7%AE%97/">
                     
										    9.基于HBase的MapReduce计算
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/hadoop%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    hadoop学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AE%9E%E9%AA%8C-%E5%9F%BA%E4%BA%8Ehadoop%E4%BA%92%E8%81%94%E7%BD%91%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98/">
                     
										    实验-基于hadoop互联网日志分析实战
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95/">
                     
										    实验记录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										java
									</a>
									
							<ul>
								<li class="file">
									<a href="/java/linux/">
                     
										    linux
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										linux
									</a>
									
							<ul>
								<li class="file">
									<a href="/linux/%E5%9F%BA%E7%A1%80/">
                     
										    基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										python
									</a>
									
							<ul>
								<li class="file">
									<a href="/python/1-%E5%9F%BA%E7%A1%80/">
                     
										    1-基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/python/2-%E7%AC%94%E8%AE%B0/">
                     
										    2-笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/3-%E6%8A%A5%E9%94%99/">
                     
										    3-报错
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/4.%E5%AE%9E%E8%B7%B5/">
                     
										    4.实践
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/lambda/">
                     
										    lambda
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/python/">
                     
										    python
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E4%BD%9C%E4%B8%9A-pyechart/">
                     
										    作业-pyechart
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E4%BD%9C%E4%B8%9A-%E5%BD%93%E5%BD%93%E7%BD%91%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%A6%E7%B1%8D%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90/">
                     
										    作业-当当网计算机书籍数据挖掘与可视化分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/">
                     
										    模拟登录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2/">
                     
										    爬取动态页面
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										tableau
									</a>
									
							<ul>
								<li class="file">
									<a href="/tableau/%E4%BD%9C%E4%B8%9A-tableau/">
                     
										    作业-tableau
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E4%BB%AA%E8%A1%A8%E6%9D%BF/">
                     
										    课件-tableau仪表板
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E5%85%A5%E9%97%A8/">
                     
										    课件-tableau入门
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E7%BB%83%E4%B9%A0/">
                     
										    课件-tableau练习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										其他笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/docker/">
                     
										    docker
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/vscode/">
                     
										    vscode
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E5%9F%BA%E7%A1%80/">
                     
										    基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E9%95%9C%E5%83%8F%E6%BA%90/">
                     
										    镜像源
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%9C%A8%E6%A0%A1%E7%BB%8F%E5%8E%86/">
                     
										    在校经历
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										报错
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/Hyper-V/">
                     
										    Hyper-V
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/github%E5%9F%BA%E7%A1%80%E8%AF%AD%E5%8F%A5/">
                     
										    github基础语句
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-deploy/">
                     
										    hexo-deploy
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-typora-img/">
                     
										    hexo-typora-img
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/linux%E8%BF%9E%E4%B8%8D%E4%B8%8A%E7%BD%91/">
                     
										    linux连不上网
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/vscode-install-config/">
                     
										    vscode-install-config
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										数仓学习
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%95%B0%E4%BB%93%E5%AD%A6%E4%B9%A0/%E7%A6%BB%E7%BA%BF%E5%AE%9E%E6%97%B6%E6%95%B0%E4%BB%93%E6%A6%82%E8%AE%BA/">
                     
										    离线实时数仓概论
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										日记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2022-12-24/">
                     
										    2022-12-24
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-13/">
                     
										    2024-1-13
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-17/">
                     
										    2024-1-17
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-19/">
                     
										    2024-1-19
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-2-15/">
                     
										    2024-2-15
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										科研经历
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E7%A7%91%E7%A0%94%E7%BB%8F%E5%8E%86/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A0%B7%E6%9C%AC%E9%97%AE%E9%A2%98/">
                     
										    深度学习图像分类中的对抗样本问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	2-笔记
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>lucky</span>
	<span>2024-06-10 10:42:08</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<hr>
<hr>
<h1 id="scrapy框架结构、工作原理"><a href="#scrapy框架结构、工作原理" class="headerlink" title="scrapy框架结构、工作原理"></a>scrapy框架结构、工作原理</h1><p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717991656049.png" alt="1717991656049"></p>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717991744879.png" alt="1717991744879"></p>
<p>流动过程</p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717991858666.png" alt="1717991858666"></p>
<h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717991753766.png" alt="1717991753766"></p>
<h3 id="Request对象"><a href="#Request对象" class="headerlink" title="Request对象"></a>Request对象</h3><p>Request对象用来描述一个HTTP请求，下面是其构造器方法的参数列表：</p>
<pre><code> Request(url[, callback, method=&#39;GET&#39;, headers, body, cookies, meta,encoding=&#39;utf-8&#39;, priority=0, dont_filter=False, errback])
</code></pre>
<p>●　url（必选）</p>
<p>请求页面的url地址，bytes或str类型，如’<a target="_blank" rel="noopener" href="http://www.python.org/doc'%E3%80%82">http://www.python.org/doc&#39;。</a><br>●　callback<br>页面解析函数， Callable类型，Request对象请求的页面下载完成后，由该参数指定的页面解析函数被调用。如果未传递该参数，默认调用Spider的parse方法。</p>
<p>●　method</p>
<p>HTTP请求的方法，默认为’GET’。</p>
<p>●　headers</p>
<p>HTTP请求的头部字典，dict类型，例如{‘Accept’: ‘text&#x2F;html’, ‘User-Agent’:Mozilla&#x2F;5.0’}。如果其中某项的值为None，就表示不发送该项HTTP头部，例如{‘Cookie’: None}，禁止发送Cookie。</p>
<p>●　body</p>
<p>HTTP请求的正文，bytes或str类型。<br>●　cookies<br>Cookie信息字典，dict类型，例如{‘currency’: ‘USD’, ‘country’: ‘UY’}。</p>
<p>●　meta</p>
<p>Request的元数据字典，dict类型，用于给框架中其他组件传递信息，比如中间件Item Pipeline。其他组件可以使用Request对象的meta属性访问该元数据字典（request.meta），也用于给响应处理函数传递信息，详见Response的meta属性。<br>●　encoding<br>url和body参数的编码默认为’utf-8’。如果传入的url或body参数是str类型，就使用该参数进行编码。<br>●　priority<br>请求的优先级默认值为0，优先级高的请求优先下载。<br>●　dont_filter<br>默认情况下（dont_filter&#x3D;False），对同一个url地址多次提交下载请求，后面的请求会被去重过滤器过滤（避免重复下载）。如果将该参数置为True，可以使请求避免被过滤，强制下载。例如，在多次爬取一个内容随时间而变化的页面时（每次使用相同的url），可以将该参数置为True。<br>●　errback<br>请求出现异常或者出现HTTP错误时（如404页面不存在）的回调函数。<br><strong>虽然参数很多，但除了url参数外，其他都带有默认值。</strong></p>
<h3 id="Response对象"><a href="#Response对象" class="headerlink" title="Response对象"></a>Response对象</h3><p>Response只是一个基类，根据响应内容的不同有如下子类：<br>●　TextResponse<br>●　HtmlResponse<br>●　XmlResponse</p>
<p>通常爬取的网页，其内容是HTML文本，创建的便是HtmlResponse对象，其中HtmlResponse和XmlResponse是TextResponse的子类。</p>
<p>●　url<br>HTTP响应的url地址，str类型。<br>●　status<br>HTTP响应的状态码，int类型，例如200，404。<br>●　headers<br>HTTP响应的头头部，类字典类型，可以调用get或getlist方法对其进行访问，例如：</p>
<pre><code> response.headers.get(&#39;Content-Type&#39;)
 response.headers.getlist(&#39;Set-Cookie&#39;)
</code></pre>
<p>●　body<br>HTTP响应正文，bytes类型。<br>●　text<br>文本形式的HTTP响应正文，str类型，它是由response.body使用response.encoding解码得到的，即</p>
<pre><code> reponse.text = response.body.decode(response.encoding)
</code></pre>
<p>●　encoding<br>HTTP响应正文的编码，它的值可能是从HTTP响应头部或正文中解析出来的。<br>●　request<br>产生该HTTP响应的Request对象。<br>●　meta<br>即response.request.meta，在构造Request对象时，可将要传递给响应处理函数的信息通过meta参数传入；响应处理函数处理响应时，通过response.meta将信息取出。<br>●　selector<br>Selector对象用于在Response中提取数据</p>
<p>●　xpath(query)</p>
<p>使用XPath选择器在Response中提取数据，实际上它是response.selector.xpath方法的快捷方式</p>
<p>●　css(query)</p>
<p>使用CSS选择器在Response中提取数据，实际上它是response.selector.css方法的快捷方式（选择器相关话题在后面章节详细讲解）。</p>
<p>●　urljoin（url）</p>
<p>用于构造绝对url。当传入的url参数是一个相对地址时，根据response.url计算出相应的绝对url。例如，response.url为<a target="_blank" rel="noopener" href="http://www.example.com/a%EF%BC%8Curl%E4%B8%BAb/index.html%EF%BC%8C%E8%B0%83%E7%94%A8response.urljoin(url)%E7%9A%84%E7%BB%93%E6%9E%9C%E4%B8%BAhttp://www.example.com/a/b/index.html%E3%80%82">http://www.example.com/a，url为b/index.html，调用response.urljoin(url)的结果为http://www.example.com/a/b/index.html。</a></p>
<h1 id="Spider开发流程"><a href="#Spider开发流程" class="headerlink" title="Spider开发流程"></a>Spider开发流程</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BooksSpider</span>(scrapy.Spider):</span><br><span class="line">    <span class="comment"># 每一个爬虫的唯一标识</span></span><br><span class="line">    name = <span class="string">&quot;books&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义爬虫爬取的起始点，起始点可以是多个，我们这里是一个</span></span><br><span class="line">    start_urls = [<span class="string">&#x27;http://books.toscrape.com/&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">self, response</span>):</span><br><span class="line">        <span class="comment"># 提取数据</span></span><br><span class="line">        <span class="comment"># 每一本书的信息是在&lt;article class=&quot;product_pod&quot;&gt;中，我们使用</span></span><br><span class="line">        <span class="comment"># css()方法找到所有这样的article 元素，并依次迭代</span></span><br><span class="line">        <span class="keyword">for</span> book <span class="keyword">in</span> response.css(<span class="string">&#x27;article.product_pod&#x27;</span>):</span><br><span class="line">            <span class="comment"># 书名信息在article &gt; h3 &gt; a 元素的title属性里</span></span><br><span class="line">            <span class="comment"># 例如: &lt;a title=&quot;A Light in the Attic&quot;&gt;A Light in the ...&lt;/a&gt;</span></span><br><span class="line">            name = book.xpath(<span class="string">&#x27;./h3/a/@title&#x27;</span>).extract_first()</span><br><span class="line">    </span><br><span class="line">            <span class="comment"># 书价信息在 &lt;p class=&quot;price_color&quot;&gt;的TEXT中。</span></span><br><span class="line">            <span class="comment"># 例如: &lt;p class=&quot;price_color&quot;&gt;￡51.77&lt;/p&gt;</span></span><br><span class="line">            price = book.css(<span class="string">&#x27;p.price_color::text&#x27;</span>).extract_first()</span><br><span class="line">            <span class="keyword">yield</span> &#123;</span><br><span class="line">                <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                <span class="string">&#x27;price&#x27;</span>: price,</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 提取链接</span></span><br><span class="line">            <span class="comment"># 下一页的url 在ul.pager &gt; li.next &gt; a 里面</span></span><br><span class="line">            <span class="comment"># 例如: &lt;li class=&quot;next&quot;&gt;&lt;a href=&quot;catalogue/page-2.html&quot;&gt;next&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line">        next_url = response.css(<span class="string">&#x27;ul.pager li.next a::attr(href)&#x27;</span>).extract_first()</span><br><span class="line">        <span class="keyword">if</span> next_url:</span><br><span class="line">            <span class="comment"># 如果找到下一页的url，得到绝对路径，构造新的Request 对象</span></span><br><span class="line">            next_url = response.urljoin(next_url)</span><br><span class="line">            <span class="keyword">yield</span> scrapy.Request(next_url, callback=self.parse)</span><br></pre></td></tr></table></figure>

<h2 id="scrapy-Spider"><a href="#scrapy-Spider" class="headerlink" title="scrapy.Spider"></a>scrapy.Spider</h2><p>Scrapy框架提供了一个Spider基类,实现了以下内容：</p>
<p>●　供Scrapy引擎调用的接口，例如用来创建Spider实例的类方法from_crawler。<br>●　供用户使用的实用工具函数，例如可以调用log方法将调试信息输出到日志。<br>●　供用户访问的属性，例如可以通过settings属性访问配置文件中的配置。</p>
<h3 id="start-urls两种方式"><a href="#start-urls两种方式" class="headerlink" title="start_urls两种方式"></a>start_urls两种方式</h3><p>Spider基类的start_requests</p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717993504641.png" alt="1717993504641"></p>
<p>实现start_requests覆盖基类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">start_requests</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">yield</span> scrapy.Request(<span class="string">&#x27;http://books.toscrape.com/&#x27;</span>,</span><br><span class="line">                              callback=self.parse_book,</span><br><span class="line">                              headers=&#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0&#x27;</span>&#125;,</span><br><span class="line">                              dont_filter=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 改用parse_book 作为回调函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">response</span>):</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717993602143.png" alt="1717993602143"></p>
<h3 id="页面解析函数"><a href="#页面解析函数" class="headerlink" title="页面解析函数"></a>页面解析函数</h3><p>页面解析函数也就是构造Request对象时通过callback参数指定的回调函数（或默认的parse方法）。页面解析函数是实现Spider中最核心的部分，它需要完成以下两项工作：<br>●　使用选择器提取页面中的数据，将数据封装后（Item或字典）提交给Scrapy引擎。<br>●　使用选择器或LinkExtractor提取页面中的链接，用其构造新的Request对象并提交给Scrapy引擎（下载链接页面）。<br>一个页面中可能包含多项数据以及多个链接，因此页面解析函数被要求返回一个可迭代对象（通常被实现成一个生成器函数），每次迭代返回一项数据（Item或字典）或一个Request对象。</p>
<h2 id="selector"><a href="#selector" class="headerlink" title="selector"></a>selector</h2><h3 id="xpath和css"><a href="#xpath和css" class="headerlink" title="xpath和css"></a>xpath和css</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; response.xpath(&#x27;.//h1/text()&#x27;).extract()</span><br><span class="line">     [&#x27;Hello World&#x27;, &#x27;Hello Scrapy&#x27;]</span><br><span class="line"> &gt;&gt;&gt; response.css(&#x27;li::text&#x27;).extract()</span><br><span class="line"> [&#x27;C++&#x27;, &#x27;Java&#x27;, &#x27;Python&#x27;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><p>XPath（XML Path Language）和 CSS（Cascading Style Sheets）是两种不同的语言，用于在网页中定位和选择元素。它们通常用于网络爬虫和数据提取的上下文中，但在实际使用中有一些区别：</p>
<ol>
<li><strong>语法</strong>：<ul>
<li>XPath 是一种针对 XML 文档的查询语言，它使用路径表达式来选取 XML 文档中的节点或节点集合。</li>
<li>CSS 选择器是一种用于 HTML 文档的选择器语言，它使用选择器来选择 HTML 文档中的元素。</li>
</ul>
</li>
<li><strong>定位方式</strong>：<ul>
<li>XPath 可以使用路径表达式沿着元素的层次结构进行定位，例如 <code>/html/body/div[1]/a</code> 表示选择 HTML 页面中第一个 <code>div</code> 元素下的第一个 <code>a</code> 元素。</li>
<li>CSS 选择器使用类似于 CSS 样式表的语法，例如 <code>div &gt; a</code> 表示选择所有直接子元素为 <code>div</code> 的 <code>a</code> 元素。</li>
</ul>
</li>
</ol>
<h4 id="xpath"><a href="#xpath" class="headerlink" title="xpath"></a>xpath</h4><p><a target="_blank" rel="noopener" href="https://www.w3.org/TR/xpath/">https://www.w3.org/TR/xpath/</a></p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717997913122.png" alt="1717997913122"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from scrapy.selector import Selector</span><br><span class="line">     &gt;&gt;&gt; from scrapy.http import HtmlResponse</span><br><span class="line">     &gt;&gt;&gt; body = &#x27;&#x27;&#x27;</span><br><span class="line">     ... &lt;html&gt;</span><br><span class="line">     ...    &lt;head&gt;</span><br><span class="line">     ...         &lt;base href=&#x27;http://example.com/&#x27; /&gt;</span><br><span class="line">     ...         &lt;title&gt;Example website&lt;/title&gt;</span><br><span class="line">     ...    &lt;/head&gt;</span><br><span class="line">     ...    &lt;body&gt;</span><br><span class="line">     ...         &lt;div id=&#x27;images&#x27;&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image1.html&#x27;&gt;Name: Image 1 &lt;br/&gt;&lt;img src=&#x27;image1.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image2.html&#x27;&gt;Name: Image 2 &lt;br/&gt;&lt;img src=&#x27;image2.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image3.html&#x27;&gt;Name: Image 3 &lt;br/&gt;&lt;img src=&#x27;image3.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image4.html&#x27;&gt;Name: Image 4 &lt;br/&gt;&lt;img src=&#x27;image4.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image5.html&#x27;&gt;Name: Image 5 &lt;br/&gt;&lt;img src=&#x27;image5.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...         &lt;/div&gt;</span><br><span class="line">     ...    &lt;/body&gt;</span><br><span class="line">     ... &lt;/html&gt;</span><br><span class="line">     ... &#x27;&#x27;&#x27;</span><br><span class="line">     ...</span><br><span class="line">     &gt;&gt;&gt; response = HtmlResponse(url=&#x27;http://www.example.com&#x27;, body=body, encoding=&#x27;utf8&#x27;)</span><br><span class="line"></span><br><span class="line">/：描述一个从根开始的绝对路径。</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; response.xpath(&#x27;/html&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;/html&#x27; data=&#x27;&lt;html&gt;\n\t&lt;head&gt;\n\t\t&lt;base href=&quot;http://exam&#x27;&gt;]</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;/html/head&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;/html/head&#x27; data=&#x27;&lt;head&gt;\n\t\t&lt;base href=&quot;http://example.com/&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">E1/E2：选中E1子节点中的所有E2。</span><br><span class="line"></span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;/html/body/div/a&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;/html/body/div/a&#x27; data=&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;/html/body/div/a&#x27; data=&#x27;&lt;a href=&quot;image2.html&quot;&gt;Name: My image 2 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;/html/body/div/a&#x27; data=&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: My image 3 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;/html/body/div/a&#x27; data=&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: My image 4 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;/html/body/div/a&#x27; data=&#x27;&lt;a href=&quot;image5.html&quot;&gt;Name: My image 5 &lt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">//E：选中文档中的所有E，无论在什么位置。</span><br><span class="line"></span><br><span class="line">     # 选中文档中的所有a</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;//a&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//a&#x27; data=&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a&#x27; data=&#x27;&lt;a href=&quot;image2.html&quot;&gt;Name: My image 2 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a&#x27; data=&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: My image 3 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a&#x27; data=&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: My image 4 &lt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a&#x27; data=&#x27;&lt;a href=&quot;image5.html&quot;&gt;Name: My image 5 &lt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">E1//E2：选中E1后代节点中的所有E2，无论在后代中的什么位置。</span><br><span class="line"></span><br><span class="line">     # 选中body后代中的所有img</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;/html/body//img&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;/html/body//img&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body//img&#x27; data=&#x27;&lt;img src=&quot;image2.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body//img&#x27; data=&#x27;&lt;img src=&quot;image3.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body//img&#x27; data=&#x27;&lt;img src=&quot;image4.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body//img&#x27; data=&#x27;&lt;img src=&quot;image5.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">E/text()：选中E的文本子节点。</span><br><span class="line"></span><br><span class="line">     # 选中所有a的文本</span><br><span class="line">     &gt;&gt;&gt; sel = response.xpath(&#x27;//a/text()&#x27;)</span><br><span class="line">     &gt;&gt;&gt; sel</span><br><span class="line">     [&lt;Selector xpath=&#x27;//a/text()&#x27; data=&#x27;Name: My image 1 &#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a/text()&#x27; data=&#x27;Name: My image 2 &#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a/text()&#x27; data=&#x27;Name: My image 3 &#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a/text()&#x27; data=&#x27;Name: My image 4 &#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//a/text()&#x27; data=&#x27;Name: My image 5 &#x27;&gt;]</span><br><span class="line">     &gt;&gt;&gt; sel.extract()</span><br><span class="line">     [&#x27;Name: My image 1 &#x27;,</span><br><span class="line">     &#x27;Name: My image 2 &#x27;,</span><br><span class="line">     &#x27;Name: My image 3 &#x27;,</span><br><span class="line">     &#x27;Name: My image 4 &#x27;,</span><br><span class="line">     &#x27;Name: My image 5 &#x27;]</span><br><span class="line"></span><br><span class="line">E/*：选中E的所有元素子节点。</span><br><span class="line"></span><br><span class="line">     # 选中html的所有元素子节点</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;/html/*&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;/html/*&#x27; data=&#x27;&lt;head&gt;\n\t\t&lt;base href=&quot;http://example.com/&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/*&#x27; data=&#x27;&lt;body&gt;\n\t\t&lt;div id=&quot;images&quot;&gt;\n\t\t\t&lt;a href=&quot;i&#x27;&gt;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     # 选中div的所有后代元素节点</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;/html/body/div//*&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;br&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;a href=&quot;image2.html&quot;&gt;Name: My image 2 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;br&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;img src=&quot;image2.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: My image 3 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;br&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;img src=&quot;image3.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: My image 4 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;br&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;img src=&quot;image4.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;a href=&quot;image5.html&quot;&gt;Name: My image 5 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;br&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;/html/body/div//*&#x27; data=&#x27;&lt;img src=&quot;image5.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">*/E：选中孙节点中的所有E。</span><br><span class="line"></span><br><span class="line">     # 选中div孙节点中的所有img</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;//div/*/img&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//div/*/img&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//div/*/img&#x27; data=&#x27;&lt;img src=&quot;image2.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//div/*/img&#x27; data=&#x27;&lt;img src=&quot;image3.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//div/*/img&#x27; data=&#x27;&lt;img src=&quot;image4.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//div/*/img&#x27; data=&#x27;&lt;img src=&quot;image5.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">E/@ATTR：选中E的ATTR属性。</span><br><span class="line"></span><br><span class="line">     # 选中所有img的src 属性</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;//img/@src&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//img/@src&#x27; data=&#x27;image1.jpg&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img/@src&#x27; data=&#x27;image2.jpg&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img/@src&#x27; data=&#x27;image3.jpg&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img/@src&#x27; data=&#x27;image4.jpg&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img/@src&#x27; data=&#x27;image5.jpg&#x27;&gt;]</span><br><span class="line">//@ATTR：选中文档中所有ATTR属性。</span><br><span class="line"></span><br><span class="line">     # 选中所有的href 属性</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;//@href&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//@href&#x27; data=&#x27;http://example.com/&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//@href&#x27; data=&#x27;image1.html&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//@href&#x27; data=&#x27;image2.html&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//@href&#x27; data=&#x27;image3.html&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//@href&#x27; data=&#x27;image4.html&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//@href&#x27; data=&#x27;image5.html&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">　E/@*：选中E的所有属性。</span><br><span class="line"></span><br><span class="line">     # 获取第一个a 下img的所有属性（这里只有src 一个属性）</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;//a[1]/img/@*&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//a[1]/img/@*&#x27; data=&#x27;image1.jpg&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">　.：选中当前节点，用来描述相对路径。</span><br><span class="line"></span><br><span class="line">     # 获取第1个a的选择器对象</span><br><span class="line">     &gt;&gt;&gt; sel = response.xpath(&#x27;//a&#x27;)[0]</span><br><span class="line">     &gt;&gt;&gt; sel</span><br><span class="line">     &lt;Selector xpath=&#x27;//a&#x27; data=&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;&#x27;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     # 假设我们想选中当前这个a 后代中的所有img，下面的做法是错误的，</span><br><span class="line">     # 会找到文档中所有的img</span><br><span class="line">     # 因为//img是绝对路径，会从文档的根开始搜索，而不是从当前的a 开始</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;//img&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//img&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img&#x27; data=&#x27;&lt;img src=&quot;image2.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img&#x27; data=&#x27;&lt;img src=&quot;image3.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img&#x27; data=&#x27;&lt;img src=&quot;image4.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">     &lt;Selector xpath=&#x27;//img&#x27; data=&#x27;&lt;img src=&quot;image5.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line">     # 需要使用.//img 来描述当前节点后代中的所有img</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;.//img&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;.//img&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">　..：选中当前节点的父节点，用来描述相对路径。</span><br><span class="line"></span><br><span class="line">     # 选中所有img的父节点</span><br><span class="line">     &gt;&gt;&gt; response.xpath(&#x27;//img/..&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;//img/..&#x27; data=&#x27;&lt;a href=&quot;image1.html&quot;&gt;Name: My image 1 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//img/..&#x27; data=&#x27;&lt;a href=&quot;image2.html&quot;&gt;Name: My image 2 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//img/..&#x27; data=&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: My image 3 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//img/..&#x27; data=&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: My image 4 &lt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//img/..&#x27; data=&#x27;&lt;a href=&quot;image5.html&quot;&gt;Name: My image 5 &lt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>字符串函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">string(arg)：返回参数的字符串值。</span><br><span class="line"></span><br><span class="line">     &gt;&gt;&gt; from scrapy.selector import Selector</span><br><span class="line">     &gt;&gt;&gt; text=&#x27;&lt;a href=&quot;#&quot;&gt;Click here to go to the &lt;strong&gt;Next Page&lt;/strong&gt;&lt;/a&gt;&#x27;</span><br><span class="line">     &gt;&gt;&gt; sel = Selector(text=text)</span><br><span class="line">     &gt;&gt;&gt; sel</span><br><span class="line">     &lt;Selector xpath=None data=&#x27;&lt;html&gt;&lt;body&gt;&lt;a href=&quot;#&quot;&gt;Click here to go&#x27;&gt;</span><br><span class="line">     # 以下做法和sel.xpath(&#x27;/html/body/a/strong/text()&#x27;)得到相同结果</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;string(/html/body/a/strong)&#x27;).extract()</span><br><span class="line">     [&#x27;Next Page&#x27;]</span><br><span class="line">     # 如果想得到a 中的整个字符串&#x27;Click here to go to the Next Page&#x27;，</span><br><span class="line">     # 使用text()就不行了，因为Click here to go to the和Next Page 在不同元素下</span><br><span class="line">     # 以下做法将得到两个子串</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;/html/body/a//text()&#x27;).extract()</span><br><span class="line">     [&#x27;Click here to go to the &#x27;, &#x27;Next Page&#x27;]</span><br><span class="line">     # 这种情况下可以使用string()函数</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;string(/html/body/a)&#x27;).extract()</span><br><span class="line">     [&#x27;Click here to go to the Next Page&#x27;]</span><br><span class="line"></span><br><span class="line">contains(str1, str2)：判断str1中是否包含str2，返回布尔值。</span><br><span class="line"></span><br><span class="line">     &gt;&gt;&gt; text = &#x27;&#x27;&#x27;</span><br><span class="line">     ... &lt;div&gt;</span><br><span class="line">     ...    &lt;p class=&quot;small info&quot;&gt;hello world&lt;/p&gt;</span><br><span class="line">     ...    &lt;p class=&quot;normal info&quot;&gt;hello scrapy&lt;/p&gt;</span><br><span class="line">     ... &lt;/div&gt;</span><br><span class="line">     ... &#x27;&#x27;&#x27;</span><br><span class="line">     &gt;&gt;&gt; sel = Selector(text=text)</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;//p[contains(@class, &quot;small&quot;)]&#x27;) # 选择class 属性中包含&quot;small&quot;的p 元素</span><br><span class="line">     [&lt;Selector xpath=&#x27;//p[contains(@class, &quot;small&quot;)]&#x27; data=&#x27;&lt;p class=&quot;small info&quot;&gt;hello world&lt;/p&gt;&#x27;&gt;]</span><br><span class="line">     &gt;&gt;&gt; sel.xpath(&#x27;//p[contains(@class, &quot;info&quot;)]&#x27;) # 选择class 属性中包含&quot;info&quot;的p 元素</span><br><span class="line">     [&lt;Selector xpath=&#x27;//p[contains(@class, &quot;info&quot;)]&#x27; data=&#x27;&lt;p class=&quot;small info&quot;&gt;hello world&lt;/p&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;//p[contains(@class, &quot;info&quot;)]&#x27; data=&#x27;&lt;p class=&quot;normal info&quot;&gt;hello scrapy&lt;/p&gt;&#x27;&gt;]</span><br></pre></td></tr></table></figure>

<h4 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h4><p><a target="_blank" rel="noopener" href="https://www.w3.org/TR/css3-selectors/">https://www.w3.org/TR/css3-selectors/</a></p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717998805725.png" alt="1717998805725"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from scrapy.selector import Selector</span><br><span class="line">     &gt;&gt;&gt; from scrapy.http import HtmlResponse</span><br><span class="line">     &gt;&gt;&gt; body = &#x27;&#x27;&#x27;</span><br><span class="line">     ... &lt;html&gt;</span><br><span class="line">     ...    &lt;head&gt;</span><br><span class="line">     ...         &lt;base href=&#x27;http://example.com/&#x27; /&gt;</span><br><span class="line">     ...         &lt;title&gt;Example website&lt;/title&gt;</span><br><span class="line">     ...    &lt;/head&gt;</span><br><span class="line">     ...    &lt;body&gt;</span><br><span class="line">     ...         &lt;div id=&#x27;images-1&#x27; style=&quot;width: 1230px;&quot;&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image1.html&#x27;&gt;Name: Image 1 &lt;br/&gt;&lt;img src=&#x27;image1.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image2.html&#x27;&gt;Name: Image 2 &lt;br/&gt;&lt;img src=&#x27;image2.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image3.html&#x27;&gt;Name: Image 3 &lt;br/&gt;&lt;img src=&#x27;image3.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...         &lt;/div&gt;</span><br><span class="line">     ...</span><br><span class="line">     ...         &lt;div id=&#x27;images-2&#x27; class=&#x27;small&#x27;&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image4.html&#x27;&gt;Name: Image 4 &lt;br/&gt;&lt;img src=&#x27;image4.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...             &lt;a href=&#x27;image5.html&#x27;&gt;Name: Image 5 &lt;br/&gt;&lt;img src=&#x27;image5.jpg&#x27; /&gt;&lt;/a&gt;</span><br><span class="line">     ...         &lt;/div&gt;</span><br><span class="line">     ...    &lt;/body&gt;</span><br><span class="line">     ... &lt;/html&gt;</span><br><span class="line">     ... &#x27;&#x27;&#x27;</span><br><span class="line">     ...</span><br><span class="line">     &gt;&gt;&gt; response = HtmlResponse(url=&#x27;http://www.example.com&#x27;, body=body, encoding=&#x27;utf8&#x27;)</span><br><span class="line"></span><br><span class="line">●　E：选中E元素。</span><br><span class="line"></span><br><span class="line">     # 选中所有的img</span><br><span class="line">     &gt;&gt;&gt; response.css(&#x27;img&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image2.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image3.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image4.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::img&#x27; data=&#x27;&lt;img src=&quot;image5.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　E1,E2：选中E1和E2元素。</span><br><span class="line"></span><br><span class="line">         # 选中所有base和title</span><br><span class="line">         &gt;&gt;&gt; response.css(&#x27;base,title&#x27;)</span><br><span class="line">         [&lt;Selector xpath=&#x27;descendant-or-self::base | descendant-or-self::title&#x27; data=&#x27;&lt;base</span><br><span class="line">     href=&quot;http://example.com/&quot;&gt;&#x27;&gt;,</span><br><span class="line">          &lt;Selector xpath=&#x27;descendant-or-self::base | descendant-or-self::title&#x27; data=&#x27;&lt;title&gt;Example</span><br><span class="line">     website&lt;/title&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　E1 E2：选中E1后代元素中的E2元素。</span><br><span class="line"></span><br><span class="line">     # div 后代中的img</span><br><span class="line">     &gt;&gt;&gt; response.css(&#x27;div img&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;descendant-or-self::div/descendant-or-self::*/img&#x27; data=&#x27;&lt;img src=&quot;image1.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::div/descendant-or-self::*/img&#x27; data=&#x27;&lt;img src=&quot;image2.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::div/descendant-or-self::*/img&#x27; data=&#x27;&lt;img src=&quot;image3.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::div/descendant-or-self::*/img&#x27; data=&#x27;&lt;img src=&quot;image4.jpg&quot;&gt;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::div/descendant-or-self::*/img&#x27; data=&#x27;&lt;img src=&quot;image5.jpg&quot;&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　E1&gt;E2：选中E1子元素中的E2元素。</span><br><span class="line"></span><br><span class="line">     # body 子元素中的div</span><br><span class="line">     &gt;&gt;&gt; response.css(&#x27;body&gt;div&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;descendant-or-self::body/div&#x27; data=&#x27;&lt;div id=&quot;images-1&quot; style=&quot;width: 1230px;&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::body/div&#x27; data=&#x27;&lt;div id=&quot;images-2&quot; class=&quot;small&quot;&gt;\n &#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　[ATTR]：选中包含ATTR属性的元素。</span><br><span class="line"></span><br><span class="line">     # 选中包含style属性的元素</span><br><span class="line">     &gt;&gt;&gt; response.css(&#x27;[style]&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;descendant-or-self::*[@style]&#x27; data=&#x27;&lt;div id=&quot;images-1&quot; style=&quot;width: 1230px;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　[ATTR=VALUE]：选中包含ATTR属性且值为VALUE的元素。</span><br><span class="line"></span><br><span class="line">          # 选中属性id值为images-1的元素</span><br><span class="line">          &gt;&gt;&gt; response.css(&#x27;[id=images-1]&#x27;)</span><br><span class="line">          [&lt;Selector xpath=&quot;descendant-or-self::*[@id = &#x27;images-1&#x27;]&quot; data=&#x27;&lt;div id=&quot;images-1&quot; style=&quot;width:</span><br><span class="line">     1230px;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　E:nth-child(n)：选中E元素，且该元素必须是其父元素的第n个子元素。# 选中每个div的第一个a</span><br><span class="line">         &gt;&gt;&gt; response.css(&#x27;div&gt;a:nth-child(1)&#x27;)</span><br><span class="line">         [&lt;Selector xpath=&quot;descendant-or-self::div/*[name() = &#x27;a&#x27; and (position() = 1)]&quot; data=&#x27;&lt;a</span><br><span class="line">     href=&quot;image1.html&quot;&gt;Name: Image 1 &lt;br&gt;&#x27;&gt;,</span><br><span class="line">          &lt;Selector xpath=&quot;descendant-or-self::div/*[name() = &#x27;a&#x27; and (position() = 1)]&quot; data=&#x27;&lt;a</span><br><span class="line">     href=&quot;image4.html&quot;&gt;Name: Image 4 &lt;br&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         # 选中第二个div的第一个a</span><br><span class="line">         &gt;&gt;&gt; response.css(&#x27;div:nth-child(2)&gt;a:nth-child(1)&#x27;)</span><br><span class="line">         [&lt;Selector xpath=&quot;descendant-or-self::*/*[name() = &#x27;div&#x27; and (position() = 2)]/*[name() = &#x27;a&#x27; and</span><br><span class="line">     (position() = 1)]&quot; data=&#x27;&lt;a href=&quot;image4.html&quot;&gt;Name: Image 4 &lt;br&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　E:first-child：选中E元素，该元素必须是其父元素的第一个子元素。</span><br><span class="line">●　E:last-child：选中E元素，该元素必须是其父元素的倒数第一个子元素。</span><br><span class="line"></span><br><span class="line">          # 选中第一个div的最后一个a</span><br><span class="line">          &gt;&gt;&gt; response.css(&#x27;div:first-child&gt;a:last-child&#x27;)</span><br><span class="line">          [&lt;Selector xpath=&quot;descendant-or-self::*/*[name() = &#x27;div&#x27; and (position() = 1)]/*[name() = &#x27;a&#x27; and</span><br><span class="line">     (position() = last())]&quot; data=&#x27;&lt;a href=&quot;image3.html&quot;&gt;Name: Image 3 &lt;br&gt;&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">●　E::text：选中E元素的文本节点。</span><br><span class="line"></span><br><span class="line">     # 选中所有a的文本</span><br><span class="line">     &gt;&gt;&gt; sel = response.css(&#x27;a::text&#x27;)</span><br><span class="line">     &gt;&gt;&gt; sel</span><br><span class="line">     [&lt;Selector xpath=&#x27;descendant-or-self::a/text()&#x27; data=&#x27;Name: Image 1 &#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::a/text()&#x27; data=&#x27;Name: Image 2 &#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::a/text()&#x27; data=&#x27;Name: Image 3 &#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::a/text()&#x27; data=&#x27;Name: Image 4 &#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;descendant-or-self::a/text()&#x27; data=&#x27;Name: Image 5 &#x27;&gt;]</span><br><span class="line">     &gt;&gt;&gt; sel.extract()</span><br><span class="line">     [&#x27;Name: Image 1 &#x27;,</span><br><span class="line">      &#x27;Name: Image 2 &#x27;,</span><br><span class="line">      &#x27;Name: Image 3 &#x27;,</span><br><span class="line">      &#x27;Name: Image 4 &#x27;,</span><br><span class="line">      &#x27;Name: Image 5 &#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="selector提取数据"><a href="#selector提取数据" class="headerlink" title="selector提取数据"></a>selector提取数据</h3><h4 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h4><p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1717997826738.png" alt="1717997826738"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> #创建对象</span><br><span class="line">    &gt;&gt;&gt; from scrapy.selector import Selector</span><br><span class="line">     &gt;&gt;&gt; text = &#x27;&#x27;&#x27;</span><br><span class="line">     ... &lt;html&gt;</span><br><span class="line">     ...    &lt;body&gt;</span><br><span class="line">     ...         &lt;h1&gt;Hello World&lt;/h1&gt;</span><br><span class="line">     ...         &lt;h1&gt;Hello Scrapy&lt;/h1&gt;</span><br><span class="line">     ...         &lt;b&gt;Hello python&lt;/b&gt;</span><br><span class="line">     ...         &lt;ul&gt;</span><br><span class="line">     ...             &lt;li&gt;C++&lt;/li&gt;</span><br><span class="line">     ...             &lt;li&gt;Java&lt;/li&gt;</span><br><span class="line">     ...             &lt;li&gt;Python&lt;/li&gt;</span><br><span class="line">     ...         &lt;/ul&gt;</span><br><span class="line">     ...    &lt;/body&gt;</span><br><span class="line">     ... &lt;/html&gt;</span><br><span class="line">     ... &#x27;&#x27;&#x27;</span><br><span class="line">     ...</span><br><span class="line">     &gt;&gt;&gt; selector = Selector(text=text)</span><br><span class="line">     &lt;Selector xpath=None data=&#x27;&lt;html&gt;\n       &lt;body&gt;\n  &lt;h1&gt;He&#x27;&gt;</span><br><span class="line"></span><br><span class="line">#也可以使用一个Response对象构造Selector对象，将其传递给Selector构造器方法的response参数：</span><br><span class="line"></span><br><span class="line">     &gt;&gt;&gt; from scrapy.selector import Selector</span><br><span class="line">     &gt;&gt;&gt; from scrapy.http import HtmlResponse</span><br><span class="line">     &gt;&gt;&gt; body = &#x27;&#x27;&#x27;</span><br><span class="line">     ... &lt;html&gt;</span><br><span class="line">     ...    &lt;body&gt;</span><br><span class="line">     ...         &lt;h1&gt;Hello World&lt;/h1&gt;</span><br><span class="line">     ...         &lt;h1&gt;Hello Scrapy&lt;/h1&gt;</span><br><span class="line">     ...         &lt;b&gt;Hello python&lt;/b&gt;</span><br><span class="line">     ...         &lt;ul&gt;</span><br><span class="line">     ...             &lt;li&gt;C++&lt;/li&gt;</span><br><span class="line">     ...             &lt;li&gt;Java&lt;/li&gt;</span><br><span class="line">     ...             &lt;li&gt;Python&lt;/li&gt;</span><br><span class="line">     ...         &lt;/ul&gt;</span><br><span class="line">     ...    &lt;/body&gt;</span><br><span class="line">     ... &lt;/html&gt;</span><br><span class="line">     ... &#x27;&#x27;&#x27;</span><br><span class="line">     ...</span><br><span class="line">     &gt;&gt;&gt; response = HtmlResponse(url=&#x27;http://www.example.com&#x27;, body=body, encoding=&#x27;utf8&#x27;)</span><br><span class="line">     &gt;&gt;&gt; selector = Selector(response=response)</span><br><span class="line">     &gt;&gt;&gt; selector</span><br><span class="line">     &lt;Selector xpath=None data=&#x27;&lt;html&gt;\n        &lt;body&gt;\n               &lt;h1&gt;He&#x27;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="选中数据"><a href="#选中数据" class="headerlink" title="选中数据"></a>选中数据</h4><h5 id="●-extract"><a href="#●-extract" class="headerlink" title="●　extract()"></a>●　extract()</h5><h5 id="●-re-自定义匹配"><a href="#●-re-自定义匹配" class="headerlink" title="●　re() 自定义匹配"></a>●　re() 自定义匹配</h5><h5 id="●-extract-first-SelectorList专有"><a href="#●-extract-first-SelectorList专有" class="headerlink" title="●　extract_first() (SelectorList专有)"></a>●　extract_first() (SelectorList专有)</h5><h5 id="●-re-first-SelectorList专有"><a href="#●-re-first-SelectorList专有" class="headerlink" title="●　re_first() (SelectorList专有)"></a>●　re_first() (SelectorList专有)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#选中数据</span><br><span class="line">#调用Selector对象的xpath方法或css方法（传入XPath或CSS选择器表达式），可以选中文档中的某个或某些部分：返回一个SelectorList对象</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; selector_list = selector.xpath(&#x27;//h1&#x27;)  # 选中文档中所有的&lt;h1&gt;</span><br><span class="line">&gt;&gt;&gt; selector_list                           # 其中包含两个&lt;h1&gt;对应的Selector 对象</span><br><span class="line">[&lt;Selector xpath=&#x27;.//h1&#x27; data=&#x27;&lt;h1&gt;Hello World&lt;/h1&gt;&#x27;&gt;,</span><br><span class="line">&lt;Selector xpath=&#x27;.//h1&#x27; data=&#x27;&lt;h1&gt;Hello Scrapy&lt;/h1&gt;&#x27;&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; for sel in selector_list:</span><br><span class="line">     ...   print(sel.xpath(&#x27;./text()&#x27;))</span><br><span class="line">     ...</span><br><span class="line">     [&lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;Hello World&#x27;&gt;]</span><br><span class="line">     [&lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;Hello Scrapy&#x27;&gt;]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; selector_list.xpath(&#x27;./text()&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;Hello World&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;Hello Scrapy&#x27;&gt;]</span><br><span class="line">&gt;&gt;&gt; selector.xpath(&#x27;.//ul&#x27;).css(&#x27;li&#x27;).xpath(&#x27;./text()&#x27;)</span><br><span class="line">     [&lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;C++&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;Java&#x27;&gt;,</span><br><span class="line">      &lt;Selector xpath=&#x27;./text()&#x27; data=&#x27;Python&#x27;&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; sl = selector.xpath(&#x27;.//li&#x27;)</span><br><span class="line">&gt;&gt;&gt; sl</span><br><span class="line">[&lt;Selector xpath=&#x27;.//li&#x27; data=&#x27;&lt;li&gt;C++&lt;/li&gt;&#x27;&gt;,</span><br><span class="line">&lt;Selector xpath=&#x27;.//li&#x27; data=&#x27;&lt;li&gt;Java&lt;/li&gt;&#x27;&gt;,</span><br><span class="line">&lt;Selector xpath=&#x27;.//li&#x27; data=&#x27;&lt;li&gt;Python&lt;/li&gt;&#x27;&gt;]</span><br><span class="line">&gt;&gt;&gt; sl[0].extract()</span><br><span class="line">&#x27;&lt;li&gt;C++&lt;/li&gt;&#x27;</span><br><span class="line">&gt;&gt;&gt; sl = selector.xpath(&#x27;.//li/text()&#x27;)</span><br><span class="line">&gt;&gt;&gt; sl</span><br><span class="line">[&lt;Selector xpath=&#x27;.//li/text()&#x27; data=&#x27;C++&#x27;&gt;,</span><br><span class="line">&lt;Selector xpath=&#x27;.//li/text()&#x27; data=&#x27;Java&#x27;&gt;,</span><br><span class="line">&lt;Selector xpath=&#x27;.//li/text()&#x27; data=&#x27;Python&#x27;&gt;]</span><br><span class="line">&gt;&gt;&gt; sl[1].extract()</span><br><span class="line">     &#x27;Java&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> &gt;&gt;&gt; sl = selector.xpath(&#x27;.//li/text()&#x27;)</span><br><span class="line"> &gt;&gt;&gt; sl</span><br><span class="line"> [&lt;Selector xpath=&#x27;.//li/text()&#x27; data=&#x27;C++&#x27;&gt;,</span><br><span class="line">  &lt;Selector xpath=&#x27;.//li/text()&#x27; data=&#x27;Java&#x27;&gt;,</span><br><span class="line">  &lt;Selector xpath=&#x27;.//li/text()&#x27; data=&#x27;Python&#x27;&gt;]</span><br><span class="line"> &gt;&gt;&gt; sl.extract()</span><br><span class="line"> [&#x27;C++&#x27;, &#x27;Java&#x27;, &#x27;Python&#x27;]</span><br><span class="line"></span><br><span class="line">#SelectorList对象还有一个extract_first方法，该方法返回其中第一个Selector对象调用extract方法的结果。通常，在SelectorList对象中只包含一个Selector对象时调用该方法，直接提取出Unicode字符串而不是列表：</span><br><span class="line"></span><br><span class="line"> &gt;&gt;&gt; sl = selector.xpath(&#x27;.//b&#x27;)</span><br><span class="line"> &gt;&gt;&gt; sl</span><br><span class="line"> [&lt;Selector xpath=&#x27;.//b&#x27; data=&#x27;&lt;b&gt;Hello Python&lt;/b&gt;&#x27;&gt;]</span><br><span class="line"> &gt;&gt;&gt; sl.extract()</span><br><span class="line"> [&#x27;&lt;b&gt;Hello Python&lt;/b&gt;&#x27;]</span><br><span class="line"> &gt;&gt;&gt; sl.extract_first()</span><br><span class="line"> &#x27;&lt;b&gt;Hello Python&lt;/b&gt;&#x27;</span><br><span class="line">    </span><br><span class="line">#有些时候，我们想使用正则表达式提取选中内容中的某部分，可以使用re方法（两个对象都有该方法）：</span><br><span class="line"></span><br><span class="line"> &gt;&gt;&gt; text = &#x27;&#x27;&#x27;</span><br><span class="line"> ... &lt;ul&gt;</span><br><span class="line"> ...    &lt;li&gt;Python 学习手册 &lt;b&gt;价格: 99.00 元&lt;/b&gt;&lt;/li&gt;</span><br><span class="line"> ...    &lt;li&gt;Python 核心编程 &lt;b&gt;价格: 88.00 元&lt;/b&gt;&lt;/li&gt;</span><br><span class="line"> ...    &lt;li&gt;Python 基础教程 &lt;b&gt;价格: 80.00 元&lt;/b&gt;&lt;/li&gt;</span><br><span class="line"> ... &lt;/ul&gt;</span><br><span class="line"> ... &#x27;&#x27;&#x27;</span><br><span class="line"> ...</span><br><span class="line"> &gt;&gt;&gt; selector = Selector(text=text)</span><br><span class="line"> &gt;&gt;&gt; selector.xpath(&#x27;.//li/b/text()&#x27;)</span><br><span class="line"> [&lt;Selector xpath=&#x27;.//li/b/text()&#x27; data=&#x27;价格: 99.00 元&#x27;&gt;,</span><br><span class="line">  &lt;Selector xpath=&#x27;.//li/b/text()&#x27; data=&#x27;价格: 88.00 元&#x27;&gt;,</span><br><span class="line">  &lt;Selector xpath=&#x27;.//li/b/text()&#x27; data=&#x27;价格: 80.00 元&#x27;&gt;]</span><br><span class="line"> &gt;&gt;&gt; selector.xpath(&#x27;.//li/b/text()&#x27;).extract()</span><br><span class="line"> [&#x27;价格: 99.00 元&#x27;, &#x27;价格: 88.00 元&#x27;, &#x27;价格: 80.00 元&#x27;]</span><br><span class="line"> &gt;&gt;&gt; selector.xpath(&#x27;.//li/b/text()&#x27;).re(&#x27;\d+\.\d+&#x27;) #只提取价格的数字部分</span><br><span class="line"> [&#x27;99.00&#x27;, &#x27;88.00&#x27;, &#x27;80.00&#x27;]</span><br><span class="line"></span><br><span class="line">#SelectorList对象的re_first方法同样返回其中的第一个Selector对象调用re方法的结果：</span><br><span class="line">&gt;&gt;&gt; selector.xpath(&#x27;.//li/b/text()&#x27;).re_first(&#x27;\d+\.\d+&#x27;)</span><br><span class="line">     &#x27;99.00&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Item封装数据"><a href="#Item封装数据" class="headerlink" title="Item封装数据"></a>Item封装数据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from scrapy import Item, Field</span><br><span class="line">class BookItem(Item):</span><br><span class="line">    name = Field()</span><br><span class="line">    price = Field()</span><br><span class="line"></span><br><span class="line">修改之前的BooksSpider，使用BookItem替代Python字典，代码如下：</span><br><span class="line"></span><br><span class="line">from ..items import BookItem</span><br><span class="line">class BooksSpider(scrapy.Spider):</span><br><span class="line">    ...</span><br><span class="line">    def parse(self, response):</span><br><span class="line">       for sel in response.css(&#x27;article.product_pod&#x27;):</span><br><span class="line">          book = BookItem()</span><br><span class="line">          book[&#x27;name&#x27;] = sel.xpath(&#x27;./h3/a/@title&#x27;).extract_first()</span><br><span class="line">          book[&#x27;price&#x27;] = sel.css(&#x27;p.price_color::text&#x27;).extract_first()</span><br><span class="line">       yield book</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"> &gt;&gt;&gt; class ForeignBookItem(BookItem):</span><br><span class="line">     ...   translator = Field()</span><br><span class="line">     ...</span><br><span class="line">     &gt;&gt;&gt; book = ForeignBookItem()</span><br><span class="line">     &gt;&gt;&gt; book[&#x27;name&#x27;] = &#x27;巴黎圣母院&#x27;</span><br><span class="line">     &gt;&gt;&gt; book[&#x27;price&#x27;] = 20.0</span><br><span class="line">     &gt;&gt;&gt; book[&#x27;translator&#x27;] = &#x27;陈敬容&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Item-Pipeline"><a href="#Item-Pipeline" class="headerlink" title="Item Pipeline"></a>Item Pipeline</h2><p>Item Pipeline是处理数据的组件，一个Item Pipeline就是一个包含特定接口的类，通常只负责一种功能的数据处理，在一个项目中可以同时启用多个Item Pipeline，它们按指定次序级联起来，形成一条数据处理流水线。</p>
<p>在创建一个Scrapy项目时，会自动生成一个pipelines.py文件，它用来放置用户自定义的Item Pipeline，</p>
<h4 id="process-item-item-spider"><a href="#process-item-item-spider" class="headerlink" title="process_item(item, spider)"></a>process_item(item, spider)</h4><p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718000815272.png" alt="1718000815272"></p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718001335010.png" alt="1718001335010"></p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718001377831.png" alt="1718001377831"></p>
<h5 id="去重DropItem"><a href="#去重DropItem" class="headerlink" title="去重DropItem"></a>去重DropItem</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from scrapy.exceptions import DropItem</span><br><span class="line">class DuplicatesPipeline(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">    self.book_set = set()</span><br><span class="line"></span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">    name = item[&#x27;name&#x27;]</span><br><span class="line">    if name in self.book_set:</span><br><span class="line">        raise DropItem(&quot;Duplicate book found: %s&quot; % item)</span><br><span class="line"></span><br><span class="line">    self.book_set.add(name)</span><br><span class="line">    return item</span><br></pre></td></tr></table></figure>



<h4 id="open-spider-self-spider"><a href="#open-spider-self-spider" class="headerlink" title="open_spider(self, spider)"></a>open_spider(self, spider)</h4><p>Spider打开时（处理数据前）回调该方法，通常该方法用于在开始处理数据之前完成某些初始化工作，如连接数据库。</p>
<h4 id="close-spider-self-spider"><a href="#close-spider-self-spider" class="headerlink" title="close_spider(self, spider)"></a>close_spider(self, spider)</h4><p>Spider关闭时（处理数据后）回调该方法，通常该方法用于在处理完所有数据之后完成某些清理工作，如关闭数据库。</p>
<h1 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h1><p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718017975617.png" alt="1718017975617"></p>
<h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scrapy startproject myproject </span><br><span class="line"><span class="comment">#myproject 替换为 Scrapy 项目的名称</span></span><br><span class="line"><span class="comment">#实现爬虫的Python文件应位于myproject /spiders目录下在该目录下创建新文件book_spider.py</span></span><br></pre></td></tr></table></figure>

<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scrapy crawl books -o books.csv</span><br><span class="line"><span class="comment">#运行爬虫&#x27;books&#x27;，并将爬取的数据存储到csv文件中：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置好数据库连接，存入数据库</span></span><br><span class="line">scrapy crawl books</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="流程和代码"><a href="#流程和代码" class="headerlink" title="流程和代码"></a>流程和代码</h3><p>1.创建项目</p>
<p>2.spiders文件夹下实现爬虫</p>
<p>3.pipelines.py中实现类，处理数据或连接数据库</p>
<p>4.将pipeline.py中的类名添加到settings.py中ITEM_PIPELINES{}中，并设置优先度（数值不重要，数值关系重要）</p>
<p>5.将爬取的数据存入mysql中，先设置好数据库和表名，表数据类型需要与pipeline数据处理返回的类型一致</p>
<p>6.表列名要与爬取的数据列名一致</p>
<h4 id="spider实现"><a href="#spider实现" class="headerlink" title="#spider实现"></a>#spider实现</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import scrapy</span><br><span class="line">class BooksSpider(scrapy.Spider):</span><br><span class="line">    # 每一个爬虫的唯一标识</span><br><span class="line">    name = &quot;books&quot;</span><br><span class="line"></span><br><span class="line">    # 定义爬虫爬取的起始点，起始点可以是多个，我们这里是一个</span><br><span class="line">    start_urls = [&#x27;http://books.toscrape.com/&#x27;]</span><br><span class="line"></span><br><span class="line">    def parse(self, response):</span><br><span class="line">        # 提取数据</span><br><span class="line">        # 每一本书的信息是在&lt;article class=&quot;product_pod&quot;&gt;中，我们使用</span><br><span class="line">        # css()方法找到所有这样的article 元素，并依次迭代</span><br><span class="line">        for book in response.css(&#x27;article.product_pod&#x27;):</span><br><span class="line">            # 书名信息在article &gt; h3 &gt; a 元素的title属性里</span><br><span class="line">            # 例如: &lt;a title=&quot;A Light in the Attic&quot;&gt;A Light in the ...&lt;/a&gt;</span><br><span class="line">            name = book.xpath(&#x27;./h3/a/@title&#x27;).extract_first()</span><br><span class="line"></span><br><span class="line">            # 书价信息在 &lt;p class=&quot;price_color&quot;&gt;的TEXT中。</span><br><span class="line">            # 例如: &lt;p class=&quot;price_color&quot;&gt;￡51.77&lt;/p&gt;</span><br><span class="line">            price = book.css(&#x27;p.price_color::text&#x27;).extract_first()</span><br><span class="line">            yield &#123;</span><br><span class="line">                &#x27;name&#x27;: name,</span><br><span class="line">                &#x27;price&#x27;: price,</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            # 提取链接</span><br><span class="line">            # 下一页的url 在ul.pager &gt; li.next &gt; a 里面</span><br><span class="line">            # 例如: &lt;li class=&quot;next&quot;&gt;&lt;a href=&quot;catalogue/page-2.html&quot;&gt;next&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        next_url = response.css(&#x27;ul.pager li.next a::attr(href)&#x27;).extract_first()</span><br><span class="line">        if next_url:</span><br><span class="line">            # 如果找到下一页的url，得到绝对路径，构造新的Request 对象</span><br><span class="line">            next_url = response.urljoin(next_url)</span><br><span class="line">            yield scrapy.Request(next_url, callback=self.parse)</span><br></pre></td></tr></table></figure>

<h4 id="pipelines-py"><a href="#pipelines-py" class="headerlink" title="#pipelines.py"></a>#pipelines.py</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">import mysql.connector#python3后用mysql.connector而不是mysal和MySQLdb</span><br><span class="line">from scrapy.exceptions import DropItem</span><br><span class="line"></span><br><span class="line">class MyprojectPipeline:</span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">        return item</span><br><span class="line"></span><br><span class="line">class DuplicatesPipeline(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.book_set = set()</span><br><span class="line"></span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">        name = item[&#x27;name&#x27;]</span><br><span class="line">        if name in self.book_set:</span><br><span class="line">            raise DropItem(&quot;Duplicate book found: %s&quot; % item)</span><br><span class="line"></span><br><span class="line">        self.book_set.add(name)</span><br><span class="line">        return item</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class PriceConverterPipeline(object):</span><br><span class="line">    # 英镑兑换人民币汇率</span><br><span class="line">    exchange_rate = 8.5309</span><br><span class="line"></span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">        # 提取item的price 字段（如￡53.74）</span><br><span class="line">        # 去掉前面英镑符号￡，转换为float 类型，乘以汇率</span><br><span class="line">        price = float(item[&#x27;price&#x27;][1:]) * self.exchange_rate</span><br><span class="line"></span><br><span class="line">        # 保留2 位小数，赋值回item的price 字段</span><br><span class="line">        item[&#x27;price&#x27;] = &#x27;%.2f&#x27; % price</span><br><span class="line"></span><br><span class="line">        return item</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MySQLPipeline(object):</span><br><span class="line">    DB_HOST = &#x27;localhost&#x27;</span><br><span class="line">    DB_USER = &#x27;root&#x27;</span><br><span class="line">    DB_PASSWORD = &#x27;123456&#x27;</span><br><span class="line">    DB_NAME = &#x27;bitest&#x27;</span><br><span class="line"></span><br><span class="line">    def open_spider(self, spider):</span><br><span class="line">        self.conn = mysql.connector.connect(</span><br><span class="line">            host=self.DB_HOST,</span><br><span class="line">            user=self.DB_USER,</span><br><span class="line">            password=self.DB_PASSWORD,</span><br><span class="line">            database=self.DB_NAME</span><br><span class="line">        )</span><br><span class="line">        self.cursor = self.conn.cursor()</span><br><span class="line"></span><br><span class="line">    def close_spider(self, spider):</span><br><span class="line">        self.conn.commit()</span><br><span class="line">        self.cursor.close()</span><br><span class="line">        self.conn.close()</span><br><span class="line"></span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">        try:</span><br><span class="line">            self.cursor.execute(</span><br><span class="line">                &quot;&quot;&quot;</span><br><span class="line">                INSERT INTO books (name, price)#sql语句</span><br><span class="line">                VALUES (%s, %s)</span><br><span class="line">                &quot;&quot;&quot;,</span><br><span class="line">                (item[&#x27;name&#x27;], float(item[&#x27;price&#x27;]))#注意数据类型</span><br><span class="line">            )</span><br><span class="line">            self.conn.commit()</span><br><span class="line">        except mysql.connector.Error as e:</span><br><span class="line">            print(f&quot;Error inserting item into database: &#123;e&#125;&quot;)</span><br><span class="line">            self.conn.rollback()</span><br><span class="line">            raise DropItem(f&quot;Failed to insert item into database: &#123;e&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        return item</span><br></pre></td></tr></table></figure>

<h4 id="settings-py"><a href="#settings-py" class="headerlink" title="#settings.py"></a>#settings.py</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#将pipeline.py添加进来使之生效</span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">        &#x27;myproject.pipelines.PriceConverterPipeline&#x27;: 300,</span><br><span class="line">        &#x27;myproject.pipelines.DuplicatesPipeline&#x27;: 350,</span><br><span class="line">        &#x27;myproject.pipelines.MySQLPipeline&#x27;: 400,</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<h1 id="提取下一页链接"><a href="#提取下一页链接" class="headerlink" title="提取下一页链接"></a>提取下一页链接</h1><h3 id="selector-1"><a href="#selector-1" class="headerlink" title="selector"></a>selector</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class BooksSpider(scrapy.Spider):</span><br><span class="line">    def parse(self, response):</span><br><span class="line">        # 提取链接</span><br><span class="line">        # 下一页的url 在ul.pager &gt; li.next &gt; a 里面</span><br><span class="line">        # 例如： &lt;li class=&quot;next&quot;&gt;&lt;a href=&quot;catalogue/page-2.html&quot;&gt;next&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        next_url = response.css(&#x27;ul.pager li.next a::attr(href)&#x27;).extract_first()</span><br><span class="line">        if next_url:</span><br><span class="line">            # 如果找到下一页的url，得到绝对路径，构造新的Request 对象</span><br><span class="line">            next_url = response.urljoin(next_url)</span><br><span class="line">            yield scrapy.Request(next_url, callback=self.parse)</span><br></pre></td></tr></table></figure>

<h3 id="LinkExtractor"><a href="#LinkExtractor" class="headerlink" title="LinkExtractor"></a>LinkExtractor</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from scrapy.linkextractors import LinkExtractor</span><br><span class="line">class BooksSpider(scrapy.Spider):</span><br><span class="line">    def parse(self, response):</span><br><span class="line">        # 提取链接</span><br><span class="line">        # 下一页的url 在ul.pager &gt; li.next &gt; a 里面</span><br><span class="line">        # 例如: &lt;li class=&quot;next&quot;&gt;&lt;a href=&quot;catalogue/page-2.html&quot;&gt;next&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        le = LinkExtractor(restrict_css=&#x27;ul.pager li.next&#x27;)</span><br><span class="line">        links = le.extract_links(response)</span><br><span class="line">        if links:</span><br><span class="line">            next_url = links[0].url</span><br><span class="line">            yield scrapy.Request(next_url, callback=self.parse)</span><br></pre></td></tr></table></figure>

<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718019790659.png" alt="1718019790659"></p>
<h4 id="提取规则"><a href="#提取规则" class="headerlink" title="提取规则"></a>提取规则</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- example1.html --&gt;</span><br><span class="line">     &lt;html&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">           &lt;div id=&quot;top&quot;&gt;</span><br><span class="line">              &lt;p&gt;下面是一些站内链接&lt;/p&gt;</span><br><span class="line">              &lt;a class=&quot;internal&quot; href=&quot;/intro/install.html&quot;&gt;Installation guide&lt;/a&gt;</span><br><span class="line">              &lt;a class=&quot;internal&quot; href=&quot;/intro/tutorial.html&quot;&gt;Tutorial&lt;/a&gt;</span><br><span class="line">              &lt;a class=&quot;internal&quot; href=&quot;../examples.html&quot;&gt;Examples&lt;/a&gt;</span><br><span class="line">           &lt;/div&gt;</span><br><span class="line">           &lt;div id=&quot;bottom&quot;&gt;</span><br><span class="line">              &lt;p&gt;下面是一些站外链接&lt;/p&gt;</span><br><span class="line">              &lt;a href=&quot;http://stackoverflow.com/tags/scrapy/info&quot;&gt;StackOverflow&lt;/a&gt;</span><br><span class="line">              &lt;a href=&quot;https://github.com/scrapy/scrapy&quot;&gt;Fork on Github&lt;/a&gt;</span><br><span class="line">           &lt;/div&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">     &lt;/html&gt;</span><br><span class="line">     &lt;!-- example2.html --&gt;</span><br><span class="line">     &lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">            &lt;script type=&#x27;text/javascript&#x27; src=&#x27;/js/app1.js&#x27;/&gt;</span><br><span class="line">            &lt;script type=&#x27;text/javascript&#x27; src=&#x27;/js/app2.js&#x27;/&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">            &lt;a href=&quot;/home.html&quot;&gt;主页&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:goToPage(&#x27;/doc.html&#x27;); return false&quot;&gt;文档&lt;/a&gt;</span><br><span class="line">            &lt;a href=&quot;javascript:goToPage(&#x27;/example.html&#x27;); return false&quot;&gt;案例&lt;/a&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">     &lt;/html&gt;</span><br><span class="line">    </span><br><span class="line">&gt;&gt;&gt; from scrapy.http import HtmlResponse</span><br><span class="line">&gt;&gt;&gt; html1 = open(&#x27;exmaple1.html&#x27;).read()</span><br><span class="line">&gt;&gt;&gt; html2 = open(&#x27;exmaple2.html&#x27;).read()</span><br><span class="line">&gt;&gt;&gt; response1 = HtmlResponse(url=&#x27;http://example1.com&#x27;, body=html1, encoding=&#x27;utf8&#x27;)</span><br><span class="line">&gt;&gt;&gt; response2 = HtmlResponse(url=&#x27;http://example2.com&#x27;, body=html2, encoding=&#x27;utf8&#x27;)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor()</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://example1.com/intro/install.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/intro/tutorial.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/../examples.html&#x27;,</span><br><span class="line">&#x27;http://stackoverflow.com/tags/scrapy/info&#x27;,</span><br><span class="line">&#x27;https://github.com/scrapy/scrapy&#x27;]</span><br><span class="line"></span><br><span class="line">#LinkExtractor构造器的所有参数都有默认值，如果构造对象时不传递任何参数（使用默认值），就提取页面中所有链接</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">allow</span><br><span class="line">接收一个正则表达式或一个正则表达式列表，提取绝对url与正则表达式匹配的链接，如果该参数为空（默认），就提取全部链接。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; pattern = &#x27;/intro/.+\.html$&#x27;</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(allow=pattern)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://example1.com/intro/install.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/intro/tutorial.html&#x27;]</span><br><span class="line"></span><br><span class="line">deny</span><br><span class="line">接收一个正则表达式或一个正则表达式列表，与allow相反，排除绝对url与正则表达式匹配的链接。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; from urllib.parse import urlparse</span><br><span class="line">&gt;&gt;&gt; pattern = patten = &#x27;^&#x27; + urlparse(response1.url).geturl()</span><br><span class="line">&gt;&gt;&gt; pattern</span><br><span class="line">&#x27;^http://example1.com&#x27;</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(deny=pattern)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://stackoverflow.com/tags/scrapy/info&#x27;,</span><br><span class="line">&#x27;https://github.com/scrapy/scrapy&#x27;]</span><br><span class="line"></span><br><span class="line">allow_domains</span><br><span class="line">一个域名或一个域名列表，提取到指定域的链接。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; domains = [&#x27;github.com&#x27;, &#x27;stackoverflow.com&#x27;]</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(allow_domains=domains)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://stackoverflow.com/tags/scrapy/info&#x27;,</span><br><span class="line">&#x27;https://github.com/scrapy/scrapy&#x27;]</span><br><span class="line"></span><br><span class="line">deny_domains</span><br><span class="line">接收一个域名或一个域名列表，与allow_domains相反，排除到指定域的链接。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(deny_domains=&#x27;github.com&#x27;)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://example1.com/intro/install.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/intro/tutorial.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/../examples.html&#x27;,</span><br><span class="line">&#x27;http://stackoverflow.com/tags/scrapy/info&#x27;]</span><br><span class="line"></span><br><span class="line">restrict_xpaths</span><br><span class="line">接收一个XPath表达式或一个XPath表达式列表，提取XPath表达式选中区域下的链接。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(restrict_xpaths=&#x27;//div[@id=&quot;top&quot;]&#x27;)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://example1.com/intro/install.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/intro/tutorial.html&#x27;,</span><br><span class="line">&#x27;http://example1.com/../examples.html&#x27;]</span><br><span class="line"></span><br><span class="line">restrict_css</span><br><span class="line">接收一个CSS选择器或一个CSS选择器列表，提取CSS选择器选中区域下的链接。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(restrict_css=&#x27;div#bottom&#x27;)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response1)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://stackoverflow.com/tags/scrapy/info&#x27;,</span><br><span class="line">&#x27;https://github.com/scrapy/scrapy&#x27;]</span><br><span class="line"></span><br><span class="line">tags</span><br><span class="line">接收一个标签（字符串）或一个标签列表，提取指定标签内的链接，默认为[&#x27;a&#x27;, &#x27;area&#x27;]。</span><br><span class="line"></span><br><span class="line">attrs</span><br><span class="line">接收一个属性（字符串）或一个属性列表，提取指定属性内的链接，默认为[&#x27;href&#x27;]。</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(tags=&#x27;script&#x27;, attrs=&#x27;src&#x27;)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response2)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://example2.com/js/app1.js&#x27;,</span><br><span class="line">&#x27;http://example2.com/js/app2.js&#x27;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">process_value</span><br><span class="line">接收一个形如func(value)的回调函数。如果传递了该参数，LinkExtractor将调用该回调函数对提取的每一个链接（如a的href）进行处理，回调函数正常情况下应返回一个字符串（处理结果），想要抛弃所处理的链接时，返回None。</span><br><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; def process(value):</span><br><span class="line">...       m = re.search(&quot;javascript:goToPage\(&#x27;(.*?)&#x27;&quot;, value)</span><br><span class="line">...       # 如果匹配，就提取其中url 并返回，不匹配则返回原值</span><br><span class="line">...       if m:</span><br><span class="line">...           value = m.group(1)</span><br><span class="line">...       return value</span><br><span class="line">…</span><br><span class="line">&gt;&gt;&gt; from scrapy.linkextractors import LinkExtractor</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(process_value=process)</span><br><span class="line">&gt;&gt;&gt; links = le.extract_links(response2)</span><br><span class="line">&gt;&gt;&gt; [link.url for link in links]</span><br><span class="line">[&#x27;http://example2.com/home.html&#x27;,</span><br><span class="line">&#x27;http://example2.com/doc.html&#x27;,</span><br><span class="line">&#x27;http://example2.com/example.html&#x27;]</span><br></pre></td></tr></table></figure>



<h1 id="Exporter导出数据"><a href="#Exporter导出数据" class="headerlink" title="Exporter导出数据"></a>Exporter导出数据</h1><p>scrapy.settings.default_settings模块：</p>
<p>（1）JSON (JsonItemExporter)<br>（2）JSON lines (JsonLinesItemExporter)<br>（3）CSV (CsvItemExporter)<br>（4）XML (XmlItemExporter)<br>（5）Pickle (PickleItemExporter)<br>（6）Marshal (MarshalItemExporter)</p>
<p>如果用户添加了新的导出数据格式（即实现了新的Exporter），可在配置文件settings.py中定义FEED_EXPORTERS，例如：</p>
<pre><code> FEED_EXPORTERS = &#123;&#39;excel&#39;: &#39;my_project.my_exporters.ExcelItemExporter&#39;&#125;
</code></pre>
<p>4种是极为常用的文本数据格式，而后两种是Python特有的</p>
<p>在导出数据时，需向Scrapy爬虫提供以下信息：<br>●　导出文件路径。<br>●　导出数据格式（即选用哪个Exporter）。</p>
<p>可以通过以下两种方式指定爬虫如何导出数据</p>
<p>（1）通过命令行参数指定。<br>（2）通过配置文件指定。</p>
<h2 id="通过命令行参数指定"><a href="#通过命令行参数指定" class="headerlink" title="通过命令行参数指定"></a>通过命令行参数指定</h2><p>指定导出文件路径时，还可以使用%(name)s和%(time)s两个特殊变量</p>
<p>scrapy crawl books -t excel -o books.xls</p>
<p>对于任意Spider的任意一次爬取，都可以使用’export_data&#x2F;%(name)s&#x2F;%(time)s.csv’作为导出路径，Scrapy爬虫</p>
<p><code>%(name)s</code>：爬虫的名称。</p>
<p><code>%(time)s</code>：导出操作发生的时间。</p>
<p>会依据Spider的名字和爬取的时间点创建导出文件：</p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718022660792.png" alt="1718022660792"></p>
<p>命令行参数只能指定导出文件路径以及导出数据格式，并且每次都在命令行里输入很长的参数让人很烦躁</p>
<h2 id="通过配置文件指定settings-py"><a href="#通过配置文件指定settings-py" class="headerlink" title="通过配置文件指定settings.py"></a>通过配置文件指定settings.py</h2><p>●　FEED_URI<br>导出文件路径。</p>
<p><code>%(name)s</code>：爬虫的名称。</p>
<pre><code> FEED_URI = &#39;export_data/%(name)s.data&#39;
</code></pre>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718025175267.png" alt="1718025175267"></p>
<p>●　FEED_FORMAT<br>导出数据格式。</p>
<pre><code> FEED_FORMAT = &#39;csv&#39;
</code></pre>
<p>●　FEED_EXPORT_ENCODING<br>导出文件编码（默认情况下json文件使用数字编码，其他使用utf-8编码）。</p>
<pre><code> FEED_EXPORT_ENCODING = &#39;gbk&#39;
</code></pre>
<p>●　FEED_EXPORT_FIELDS<br>导出数据包含的字段（默认情况下导出所有字段），并指定次序。</p>
<pre><code> FEED_EXPORT_FIELDS = [&#39;name&#39;, &#39;author&#39;, &#39;price&#39;]
</code></pre>
<p>●　FEED_EXPORTERS<br>用户自定义Exporter字典，添加新的导出数据格式时使用。</p>
<pre><code> FEED_EXPORTERS = &#123;&#39;excel&#39;: &#39;my_project.my_exporters.ExcelItemExporter&#39;&#125;
</code></pre>
<h2 id="实现export指定导出文件格式"><a href="#实现export指定导出文件格式" class="headerlink" title="实现export指定导出文件格式"></a>实现export指定导出文件格式</h2><p>实现export  -&gt;  settings.py添加export</p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718024350286.png" alt="1718024350286"></p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718025175267.png" alt="1718025175267"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from scrapy.exporters import BaseItemExporter</span><br><span class="line">import xlwt# 第三方库xlwt支持python语言对Excel表格的操作</span><br><span class="line">class ExcelItemExporter(BaseItemExporter):</span><br><span class="line">    # 初始化导出器</span><br><span class="line">    def __init__(self, file, **kwargs):</span><br><span class="line">        # 调用父类的配置方法</span><br><span class="line">        self._configure(kwargs)</span><br><span class="line">        # 设置文件属性</span><br><span class="line">        self.file = file</span><br><span class="line">        # 创建一个新的 Excel 工作簿</span><br><span class="line">        self.wbook = xlwt.Workbook()</span><br><span class="line">        # 在工作簿中添加一个名为 &#x27;scrapy&#x27; 的工作表</span><br><span class="line">        self.wsheet = self.wbook.add_sheet(&#x27;scrapy&#x27;)</span><br><span class="line">        # 初始化行号为 0</span><br><span class="line">        self.row = 0</span><br><span class="line"></span><br><span class="line">    # 完成导出操作</span><br><span class="line">    def finish_exporting(self):</span><br><span class="line">        # 保存 Excel 工作簿到文件中</span><br><span class="line">        self.wbook.save(self.file)</span><br><span class="line"></span><br><span class="line">    # 导出 Item 数据到 Excel 文件</span><br><span class="line">    def export_item(self, item):</span><br><span class="line">        # 获取 Item 的字段和对应的值</span><br><span class="line">        fields = self._get_serialized_fields(item)</span><br><span class="line">        # 遍历每个字段和值，写入 Excel 工作表中</span><br><span class="line">        for col, v in enumerate(x for _, x in fields):</span><br><span class="line">            self.wsheet.write(self.row, col, v)</span><br><span class="line">        # 增加行号，准备处理下一个 Item</span><br><span class="line">        self.row += 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="下载文件FilePipeline"><a href="#下载文件FilePipeline" class="headerlink" title="下载文件FilePipeline"></a>下载文件FilePipeline</h1><p>步骤　01　在配置文件settings.py中启用FilesPipeline，通常将其置于其他Item Pipeline之前：</p>
<pre><code> ITEM_PIPELINES = &#123;&#39;scrapy.pipelines.files.FilesPipeline&#39;: 1&#125;
</code></pre>
<p>步骤　02　在配置文件settings.py中，使用FILES_STORE指定文件下载目录，如：</p>
<pre><code> FILES_STORE = &#39;/home/liushuo/Download/scrapy&#39;
</code></pre>
<p>步骤　03　在Spider解析一个包含文件下载链接的页面时，将所有需要下载文件的url地址收集到一个列表，赋给item的file_urls字段（item[‘file_urls’]）。FilesPipeline在处理每一项item时，会读取item[‘file_urls’]，对其中每一个url进行下载，Spider示例代码如下：</p>
<pre><code> class DownloadBookSpider(scrapy.Spider):
    ...


class DownloadBookSpider(scrapy.Spider):
    def parse(response):
        item = &#123;&#125;
        # 下载列表
        item[&#39;file_urls&#39;] = []
        for url in response.xpath(&#39;//a/@href&#39;).extract():
            download_url = response.urljoin(url)
            # 将url 填入下载列表
            item[&#39;file_urls&#39;].append(download_url)
        yield item
</code></pre>
<p>当FilesPipeline下载完item[‘file_urls’]中的所有文件后，会将各文件的下载结果信息收集到另一个列表，赋给item的files字段（item[‘files’]）。下载结果信息包括以下内容：<br>●　Path文件下载到本地的路径（相对于FILES_STORE的相对路径）。<br>●　Checksum文件的校验和。<br>●　url文件的url地址。</p>
<h1 id="下载图片ImagesPipeline"><a href="#下载图片ImagesPipeline" class="headerlink" title="下载图片ImagesPipeline"></a>下载图片ImagesPipeline</h1><p>ImagesPipeline是FilesPipeline的子类</p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718071797277.png" alt="1718071797277"></p>
<p><img src="/../../source/images/2-%E7%AC%94%E8%AE%B0/1718071911515.png" alt="1718071911515"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">IMAGES_THUMBS = &#123;</span><br><span class="line">        &#x27;small&#x27;: (50, 50),</span><br><span class="line">        &#x27;big&#x27;: (270, 270),</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">IMAGES_MIN_WIDTH = 110</span><br><span class="line">IMAGES_MIN_HEIGHT = 110</span><br></pre></td></tr></table></figure>




























































































































































</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/python/3-%E6%8A%A5%E9%94%99/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  3-报错
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/python/1-%E5%9F%BA%E7%A1%80/">
			  
			
				  <!-- 在这里访问 page.next.slug -->
				  python/1-基础
				
				<i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>






	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">lucky</a>
	
	
	
	<br>
	Email:wuliurong2021nnnu@163.com
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>