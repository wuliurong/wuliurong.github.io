<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		spark学习笔记 | 
	 
	hi
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

	
	

<meta name="generator" content="Hexo 7.0.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">hi</a>

	<ul id="menu">
    

    

    

    
      
      
        <li class="menu-item">
          <a href='' class="menu-item-link" target="_blank">
            
          </a>
        </li>
      
    
  
    
      <li class="menu-item">
        <a href='https://github.com/wuliurong' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Spark
									</a>
									
							<ul>
								<li class="file">
									<a href="/Spark/1-spark%E8%BD%AF%E4%BB%B6%E6%A0%88/">
                     
										    1-spark软件栈
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/centos%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    centos搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E4%BD%BF%E7%94%A8/">
                     
										    rdd使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E7%AC%94%E8%AE%B0/">
                     
										    rdd笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/scala%E5%9F%BA%E7%A1%80/">
                     
										    scala基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/Spark/spark%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    spark学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/spark%E6%BA%90%E7%A0%81%E5%9F%BA%E7%A1%80/">
                     
										    spark源码基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/windows%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    windows搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E4%BD%BF%E7%94%A8IDEA%E5%9C%A8Maven%E4%B8%AD%E5%88%9B%E5%BB%BAjava%E5%92%8Cscala%E9%A1%B9%E7%9B%AE/">
                     
										    使用IDEA在Maven中创建java和scala项目
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E8%AF%BE%E5%90%8E%E5%B0%8F%E7%BB%93/">
                     
										    课后小结
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0%E4%B8%8E%E5%AE%9E%E9%AA%8C/">
                     
										    课堂笔记与实验
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hadoop
									</a>
									
							<ul>
								<li class="file">
									<a href="/hadoop/0.%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/">
                     
										    0.基本配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/1.Hadoop%E6%90%AD%E5%BB%BA%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%A8%A1%E5%BC%8F%E7%8E%AF%E5%A2%83/">
                     
										    1.Hadoop搭建伪分布式模式环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/10.%E8%BF%90%E8%90%A5%E5%95%86%E5%85%B3%E4%BA%8E%E7%94%A8%E6%88%B7%E5%9F%BA%E7%AB%99%E5%81%9C%E7%95%99%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/">
                     
										    10.运营商关于用户基站停留数据统计
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/11.Sqoop%E5%BA%94%E7%94%A8/">
                     
										    11.Sqoop应用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/2.%E9%80%9A%E8%BF%87shell%E5%91%BD%E4%BB%A4%E8%AE%BF%E9%97%AEHDFS/">
                     
										    2.通过shell命令访问HDFS
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/3.%E9%80%9A%E8%BF%87API%E8%AE%BF%E9%97%AEHDFS/">
                     
										    3.通过API访问HDFS
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/4.%E5%88%86%E6%9E%90%E7%BC%96%E5%86%99WordCount%E7%A8%8B%E5%BA%8F/">
                     
										    4.分析编写WordCount程序
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/5.Mapreduce%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%88%86%E5%8C%BA/">
                     
										    5.Mapreduce序列化和分区
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/6.MapReduce%E5%AE%9E%E9%AA%8Csales/">
                     
										    6.MapReduce实验sales
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/7.hive%E5%AE%9E%E9%AA%8C/">
                     
										    7.hive实验
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/8.%E6%90%9C%E7%8B%97%E6%97%A5%E5%BF%97%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90MapReduce+hive/">
                     
										    8.搜狗日志查询分析MapReduce+hive
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/9.%E5%9F%BA%E4%BA%8EHBase%E7%9A%84MapReduce%E8%AE%A1%E7%AE%97/">
                     
										    9.基于HBase的MapReduce计算
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/hadoop%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    hadoop学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AE%9E%E9%AA%8C-%E5%9F%BA%E4%BA%8Ehadoop%E4%BA%92%E8%81%94%E7%BD%91%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98/">
                     
										    实验-基于hadoop互联网日志分析实战
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95/">
                     
										    实验记录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										java
									</a>
									
							<ul>
								<li class="file">
									<a href="/java/linux/">
                     
										    linux
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										linux
									</a>
									
							<ul>
								<li class="file">
									<a href="/linux/%E5%9F%BA%E7%A1%80/">
                     
										    基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										python
									</a>
									
							<ul>
								<li class="file">
									<a href="/python/1-%E5%9F%BA%E7%A1%80/">
                     
										    1-基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/2-%E7%AC%94%E8%AE%B0/">
                     
										    2-笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/3-%E6%8A%A5%E9%94%99/">
                     
										    3-报错
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/4.%E5%AE%9E%E8%B7%B5/">
                     
										    4.实践
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/lambda/">
                     
										    lambda
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/python/">
                     
										    python
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E4%BD%9C%E4%B8%9A-pyechart/">
                     
										    作业-pyechart
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E4%BD%9C%E4%B8%9A-%E5%BD%93%E5%BD%93%E7%BD%91%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%A6%E7%B1%8D%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90/">
                     
										    作业-当当网计算机书籍数据挖掘与可视化分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/">
                     
										    模拟登录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2/">
                     
										    爬取动态页面
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										tableau
									</a>
									
							<ul>
								<li class="file">
									<a href="/tableau/%E4%BD%9C%E4%B8%9A-tableau/">
                     
										    作业-tableau
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E4%BB%AA%E8%A1%A8%E6%9D%BF/">
                     
										    课件-tableau仪表板
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E5%85%A5%E9%97%A8/">
                     
										    课件-tableau入门
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E7%BB%83%E4%B9%A0/">
                     
										    课件-tableau练习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										其他笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/docker/">
                     
										    docker
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/vscode/">
                     
										    vscode
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E5%9F%BA%E7%A1%80/">
                     
										    基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E9%95%9C%E5%83%8F%E6%BA%90/">
                     
										    镜像源
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%9C%A8%E6%A0%A1%E7%BB%8F%E5%8E%86/">
                     
										    在校经历
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										报错
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/Hyper-V/">
                     
										    Hyper-V
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/github%E5%9F%BA%E7%A1%80%E8%AF%AD%E5%8F%A5/">
                     
										    github基础语句
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-deploy/">
                     
										    hexo-deploy
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-typora-img/">
                     
										    hexo-typora-img
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/linux%E8%BF%9E%E4%B8%8D%E4%B8%8A%E7%BD%91/">
                     
										    linux连不上网
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/vscode-install-config/">
                     
										    vscode-install-config
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										数仓学习
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%95%B0%E4%BB%93%E5%AD%A6%E4%B9%A0/%E7%A6%BB%E7%BA%BF%E5%AE%9E%E6%97%B6%E6%95%B0%E4%BB%93%E6%A6%82%E8%AE%BA/">
                     
										    离线实时数仓概论
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										日记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2022-12-24/">
                     
										    2022-12-24
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-13/">
                     
										    2024-1-13
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-17/">
                     
										    2024-1-17
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-19/">
                     
										    2024-1-19
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-2-15/">
                     
										    2024-2-15
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										科研经历
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E7%A7%91%E7%A0%94%E7%BB%8F%E5%8E%86/%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A0%B7%E6%9C%AC%E9%97%AE%E9%A2%98/">
                     
										    图像分类中的对抗样本问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	spark学习笔记
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>lucky</span>
	<span>2024-06-15 18:53:25</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<h1 id="spark基础"><a href="#spark基础" class="headerlink" title="spark基础"></a>spark基础</h1><h2 id="wordcount√"><a href="#wordcount√" class="headerlink" title="wordcount√"></a>wordcount√</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718462598619.png" alt="1718462598619"></p>
<h2 id="为什么要拆分为执行阶段？√"><a href="#为什么要拆分为执行阶段？√" class="headerlink" title="为什么要拆分为执行阶段？√"></a>为什么要拆分为执行阶段？√</h2><p>第1个好处是stage中生成的task不会太大，也不 会太小，而且是同构的，便于并行执行。</p>
<p>第2个好处是可以将多个操作 放在一个task里处理，使得操作可以进行串行、流水线式的处理，这样 </p>
<p>可以提高数据处理效率。</p>
<p>第3个好处是stage可以方便错误容忍，如一个s tage失效，我们可以重新运行这个stage，而不需要运行整个job。</p>
<h2 id="为什么叫transformation（）？√"><a href="#为什么叫transformation（）？√" class="headerlink" title="为什么叫transformation（）？√"></a>为什么叫transformation（）？√</h2><p>为什么操作叫作transformati </p>
<p>on（）？transformation这个词隐含了一个意思是单向操作，也就是rdd1 </p>
<p>使用transformation（）后，会生成新的rdd2，而不能对rdd1本身进行修 </p>
<p>改。</p>
<p>Spark将这些数据操作分为两种：transformation（）操作和actio </p>
<p>n（）操作。两者的区别是action（）操作一般是对数据结果进行后处理 </p>
<p>（post-processing），产生输出结果，而且会触发Spark提交job真正执行 </p>
<p>数据处理任务（在下一章中详细介绍）。</p>
<p>rdd1.count（）操作可 </p>
<p>以统计rdd1中包含的元素个数，rdd1.collect（）操作可以将rdd1中的所 </p>
<p>有元素汇集到Driver节点，并进行进一步处理。 </p>
<h2 id="①根据应用程序如何产生RDD，产生什么样的RDD？"><a href="#①根据应用程序如何产生RDD，产生什么样的RDD？" class="headerlink" title="①根据应用程序如何产生RDD，产生什么样的RDD？"></a>①根据应用程序如何产生RDD，产生什么样的RDD？</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718550728434.png" alt="1718550728434"></p>
<h2 id="②如何建立RDD之间的数据依赖关系？"><a href="#②如何建立RDD之间的数据依赖关系？" class="headerlink" title="②如何建立RDD之间的数据依赖关系？"></a>②如何建立RDD之间的数据依赖关系？</h2><h2 id="③如何计算RDD中的数据？"><a href="#③如何计算RDD中的数据？" class="headerlink" title="③如何计算RDD中的数据？"></a>③如何计算RDD中的数据？</h2><h2 id="①-如何建立RDD之间的数据依赖关系？例如，生成的RDD是依赖-于一个parent-RDD，还是多个parent-RDD？"><a href="#①-如何建立RDD之间的数据依赖关系？例如，生成的RDD是依赖-于一个parent-RDD，还是多个parent-RDD？" class="headerlink" title="① 如何建立RDD之间的数据依赖关系？例如，生成的RDD是依赖 于一个parent RDD，还是多个parent RDD？"></a>① 如何建立RDD之间的数据依赖关系？例如，生成的RDD是依赖 于一个parent RDD，还是多个parent RDD？</h2><h2 id="②新生成的RDD应该包含多少个分区？"><a href="#②新生成的RDD应该包含多少个分区？" class="headerlink" title="②新生成的RDD应该包含多少个分区？"></a>②新生成的RDD应该包含多少个分区？</h2><h2 id="③-新生成的RDD与其parent-RDD中的分区间是什么依赖关系？是-依赖parent-RDD中的一个分区还是多个分区呢？-√"><a href="#③-新生成的RDD与其parent-RDD中的分区间是什么依赖关系？是-依赖parent-RDD中的一个分区还是多个分区呢？-√" class="headerlink" title="③ 新生成的RDD与其parent RDD中的分区间是什么依赖关系？是 依赖parent RDD中的一个分区还是多个分区呢？ √"></a>③ 新生成的RDD与其parent RDD中的分区间是什么依赖关系？是 依赖parent RDD中的一个分区还是多个分区呢？ √</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718547701039.png" alt="1718547701039"></p>
<p>如果从数据流角度解释， 宽依赖表示新生成的child RDD中的分区依赖parent RDD中的每个分区 的一部分</p>
<p>如果新生成的child RDD中每个分区都依赖parent RDD 中的一部分分区，那么这个分区依赖关系被称为NarrowDependency</p>
<p>窄依赖、宽依赖的区别是child RDD的各个分区是否完全依赖parent RDD的一个或者多个分区</p>
<p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718547809630.png" alt="1718547809630"></p>
<h2 id="数据依赖分类有什么用？√"><a href="#数据依赖分类有什么用？√" class="headerlink" title="数据依赖分类有什么用？√"></a>数据依赖分类有什么用？√</h2><p>1.明确rdd分区之间的依赖关系，在执行spark时候可以确定从哪里获取数据，输出数据到哪里</p>
<p>2，有利于代码实现物理执行计划，根据操作的计算逻辑选择合适的数据依赖进行实现</p>
<h2 id="如何对RDD内部的数据进行分区？"><a href="#如何对RDD内部的数据进行分区？" class="headerlink" title="如何对RDD内部的数据进行分区？"></a>如何对RDD内部的数据进行分区？</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718548418831.png" alt="1718548418831"></p>
<h3 id="详细了解hash分区"><a href="#详细了解hash分区" class="headerlink" title="详细了解hash分区"></a>详细了解hash分区</h3><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718550537500.png" alt="1718550537500"></p>
<p> <a target="_blank" rel="noopener" href="https://blog.csdn.net/zhousenshan/article/details/132911943">Hash分片，一致性Hash分片和按照数据范围分片三种常用的数据分片方式-CSDN博客</a> </p>
<h2 id="sample和smapleByKey√"><a href="#sample和smapleByKey√" class="headerlink" title="sample和smapleByKey√"></a>sample和smapleByKey√</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718592234535.png" alt="1718592234535"></p>
<p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718592317842.png" alt="1718592317842"></p>
<p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718592355226.png" alt="1718592355226"></p>
<h2 id="reduceByKey和aggregateByKey√"><a href="#reduceByKey和aggregateByKey√" class="headerlink" title="reduceByKey和aggregateByKey√"></a>reduceByKey和aggregateByKey√</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718593674422.png" alt="1718593674422"></p>
<p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718593695860.png" alt="1718593695860"></p>
<p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718593706008.png" alt="1718593706008"></p>
<h2 id="sortByKey-SecondarySort"><a href="#sortByKey-SecondarySort" class="headerlink" title="sortByKey -&gt; SecondarySort"></a>sortByKey -&gt; SecondarySort</h2><p>spark中sortByKey时，value是无序的，在hadoop的mapReduce中可以使用SecondarySort方法，在spark中实现value排序有两种方法</p>
<p>1.如SecondarySort，将value放到key中重新定义key排序达到同时排序key和value，首先使用map（）将value放到key中生成（key，value），重新定义排序含食宿compare（），最后使用sortBykey（）进行排序只输出key</p>
<p>2.先使用groupByKey将数据聚合成key：list（value），再使用rdd.mapValues(sort function)对list（value）进行排序</p>
<h2 id="repartitionAndSortWithinPartitions比repartition-sortbykey效率高"><a href="#repartitionAndSortWithinPartitions比repartition-sortbykey效率高" class="headerlink" title="repartitionAndSortWithinPartitions比repartition+sortbykey效率高"></a>repartitionAndSortWithinPartitions比repartition+sortbykey效率高</h2><p><img src="/.io//hexo\blog\source\source\images\spark学习笔记\1718599534784.png" alt="1718599534784"></p>
<p>repatition语义与coalesce（numpartitions，shuffle&#x3D;true）一致，具体方法是为rdd中的每一个record添加一个特殊的key，根据key的hash值将数据分发到不同rdd中，然后去掉key</p>
<p>sortByKey（）为保证rdd中的数据全局有序，采用Range划分数据</p>
<p>repartitionAndSorWithinPartitions将数据分发到不同的分区，在分区中按照key排序，不能保证全局有序</p>
<p>repartition在将数据分发到不同的partition时，对特殊的key进行sort一次，在sortByKey时对key排序一次，遍历了两次数据</p>
<p>repartitionAndSorWithinPartitions分发数据到不同区，在各区内排序，只遍历了一次数据</p>
<h2 id="如何有一套通用的方法来-将任意的逻辑处理流程拆分为执行阶段？"><a href="#如何有一套通用的方法来-将任意的逻辑处理流程拆分为执行阶段？" class="headerlink" title="如何有一套通用的方法来 将任意的逻辑处理流程拆分为执行阶段？"></a>如何有一套通用的方法来 将任意的逻辑处理流程拆分为执行阶段？</h2><h2 id="task执行的时候是否会保存每-一个RDD的中间数据？"><a href="#task执行的时候是否会保存每-一个RDD的中间数据？" class="headerlink" title="task执行的时候是否会保存每 一个RDD的中间数据？"></a>task执行的时候是否会保存每 一个RDD的中间数据？</h2><h2 id="Shuffle机制如何实现"><a href="#Shuffle机制如何实现" class="headerlink" title="Shuffle机制如何实现"></a>Shuffle机制如何实现</h2><h1 id="理解RDD"><a href="#理解RDD" class="headerlink" title="理解RDD"></a>理解RDD</h1><h2 id="rdd分区"><a href="#rdd分区" class="headerlink" title="rdd分区"></a>rdd分区</h2><p>rdd计算以分区为单位进行，同一个分区的数据都进行相同的计算，对与一个分区要么都执行要么都不执行，所以的rdd的计算是粗粒度计算操作。</p>
<h2 id="计算函数"><a href="#计算函数" class="headerlink" title="计算函数"></a>计算函数</h2><p>rdd数据来源：数据源或集合加载、其他rdd转换</p>
<p>无论通过哪种方式，rdd数据集其实都是通过rdd计算函数得到的。</p>
<h2 id="rdd创建"><a href="#rdd创建" class="headerlink" title="rdd创建"></a>rdd创建</h2><p>1.spark在加载HDFS中的数据时，每个分区数据通过计算函数加载对应的block块的数据，从而实现数据的分布式加载过程</p>
<p>2.从集合中创建，实现每个分区加载一个集合中的部分数据，如SparkContext中实现的parallelize的并行集合的方法。甚至用户可以自定义分区函数实现特定加载数据的方式，如将历史数据van找时间进行加载等。</p>
<h2 id="rdd属性"><a href="#rdd属性" class="headerlink" title="rdd属性"></a>rdd属性</h2><p>数据源创建、其他rdd转换、Shuffle得到的新rdd，都离不开两个属性：分区和计算函数。只有知道rdd是如何被分区的、这个rdd一共有多少个分区，才能够通过rdd的计算函数计算每一个分区的数据。（1个rdd中对前rdd先分区对自身计算后得到自身）</p>
<p>rdd的计算函数返回值都是迭代器类型，该迭代器中能够返回rdd中某分区的所有数据。迭代器逐个处理分区的数据，避免一次性加载大量数据到内存中进行计算。</p>
<p>因为rdd一般数据量会非常大，无法一次性将数据加载至内存中，只能通过迭代器将rdd数据一条一条的返回，从而避免占用大量内存</p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E9%95%9C%E5%83%8F%E6%BA%90/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  镜像源
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/%E6%97%A5%E8%AE%B0/2022-12-24/">
			  
			
				  <!-- 在这里访问 page.next.slug -->
				  日记/2022-12-24
				
				<i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>






	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">lucky</a>
	
	
	
	<br>
	Email:wuliurong2021nnnu@163.com
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>