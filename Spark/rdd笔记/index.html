<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		rdd笔记 | 
	 
	hi
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

	
	

<meta name="generator" content="Hexo 7.0.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">hi</a>

	<ul id="menu">
    

    

    

    
      
      
        <li class="menu-item">
          <a href='' class="menu-item-link" target="_blank">
            
          </a>
        </li>
      
    
  
    
      <li class="menu-item">
        <a href='https://github.com/wuliurong' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Docker
									</a>
									
							<ul>
								<li class="file">
									<a href="/Docker/%E9%97%AE%E9%A2%98/">
                     
										    问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Spark
									</a>
									
							<ul>
								<li class="file">
									<a href="/Spark/1-spark%E8%BD%AF%E4%BB%B6%E6%A0%88/">
                     
										    1-spark软件栈
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/centos%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    centos搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E4%BD%BF%E7%94%A8/">
                     
										    rdd使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/Spark/rdd%E7%AC%94%E8%AE%B0/">
                     
										    rdd笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/windows%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    windows搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										python
									</a>
									
							<ul>
								<li class="file">
									<a href="/python/lambda/">
                     
										    lambda
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/python/">
                     
										    python
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										tableau
									</a>
									
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E4%BB%AA%E8%A1%A8%E6%9D%BF/">
                     
										    课件-tableau仪表板
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E5%85%A5%E9%97%A8/">
                     
										    课件-tableau入门
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E7%BB%83%E4%B9%A0/">
                     
										    课件-tableau练习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E4%BD%9C%E4%B8%9A-pyechart/">
                     
										    作业-pyechart
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/">
                     
										    作业-scrapy+mysql+kettle+flask+tableau+数据挖掘+navicat
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E4%BD%9C%E4%B8%9A-tableau/">
                     
										    作业-tableau
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										其他笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/vscode/">
                     
										    vscode
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8Btcpip/">
                     
										    网络编程tcpip
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										报错
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/github%E5%9F%BA%E7%A1%80%E8%AF%AD%E5%8F%A5/">
                     
										    github基础语句
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-deploy/">
                     
										    hexo-deploy
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-typora-img/">
                     
										    hexo-typora-img
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/vscode-install-config/">
                     
										    vscode-install-config
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										日记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-13/">
                     
										    2024-1-13
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-17/">
                     
										    2024-1-17
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-19/">
                     
										    2024-1-19
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-2-15/">
                     
										    2024-2-15
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										爬虫
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/1-%E5%9F%BA%E7%A1%80/">
                     
										    1-基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/2-%E7%AC%94%E8%AE%B0/">
                     
										    2-笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/3-%E6%8A%A5%E9%94%99/">
                     
										    3-报错
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/4.%E5%AE%9E%E8%B7%B5/">
                     
										    4.实践
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/">
                     
										    模拟登录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2/">
                     
										    爬取动态页面
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	rdd笔记
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>lucky</span>
	<span>2024-06-09 17:16:13</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<h1 id="一、基础"><a href="#一、基础" class="headerlink" title="一、基础"></a>一、基础</h1><h2 id="工作方式"><a href="#工作方式" class="headerlink" title="工作方式"></a>工作方式</h2><p>(1) 从外部数据创建出输入 RDD。<br>(2) 使用诸如 filter()这样的转化操作对 RDD 进行转化，以定义新的 RDD。<br>(3) 告诉 Spark 对需要被重用的中间结果 RDD 执行 persist()操作。<br>(4) 使用行动操作（例如 count()和 first()等）来触发一次并行计算，Spark 会对计算进行优化后再执行。</p>
<h2 id="惰性"><a href="#惰性" class="headerlink" title="惰性"></a>惰性</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717933378906.png" alt="1717933378906"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717933732833.png" alt="1717933732833"></p>
<h2 id="谱系图"><a href="#谱系图" class="headerlink" title="谱系图"></a>谱系图</h2><p>有向无环，往前推，宽依赖stage+1，窄依赖加入前一stage</p>
<img src="../../source/images/rdd笔记/1717933426618.png" alt="1717933426618" style="zoom: 80%;">



<h2 id="行动操作"><a href="#行动操作" class="headerlink" title="行动操作"></a>行动操作</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717933632560.png" alt="1717933632560"></p>
<h2 id="python传递函数"><a href="#python传递函数" class="headerlink" title="python传递函数"></a>python传递函数</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717934216426.png" alt="1717934216426"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717934350782.png" alt="1717934350782"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717934358427.png" alt="1717934358427"></p>
<h2 id="map和flatmap"><a href="#map和flatmap" class="headerlink" title="map和flatmap"></a>map和flatmap</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717934527741.png" alt="1717934527741"></p>
<h2 id="伪集合"><a href="#伪集合" class="headerlink" title="伪集合"></a>伪集合</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717934640036.png" alt="1717934640036"></p>
<h2 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717934887495.png" alt="1717934887495"></p>
<img src="../../source/images/rdd笔记/1717934953894.png" alt="1717934953894" style="zoom:80%;">



<h2 id="aggregate"><a href="#aggregate" class="headerlink" title="aggregate()"></a>aggregate()</h2><p>从返回值类型必须与所操作的 RDD 类型相同的限制中解放出来，通常返回不同类型的函数</p>
<h2 id="不同RDD类型间转换"><a href="#不同RDD类型间转换" class="headerlink" title="不同RDD类型间转换"></a>不同RDD类型间转换</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717936017554.png" alt="1717936017554"></p>
<h2 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717936259907.png" alt="1717936259907"></p>
<p> <strong>序列化</strong>是将数据结构或对象转换为一种特定格式，以便于存储、传输或在不同系统之间进行交换的过程。序列化的目的是将数据转换为一种通用的格式，使得数据可以被保存到文件、数据库或通过网络传输，并且在不同的编程语言和平台之间进行交互。 </p>
<p>**unpersist()**，调用该方法可以手动把持久化的 RDD 从缓存中移除</p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717936392829.png" alt="1717936392829"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717936401973.png" alt="1717936401973"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717936417710.png" alt="1717936417710"></p>
<h2 id="分区"><a href="#分区" class="headerlink" title="分区"></a>分区</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717936738149.png" alt="1717936738149"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717941567089.png" alt="1717941567089"></p>
<h2 id="创建Pair-RDD"><a href="#创建Pair-RDD" class="headerlink" title="创建Pair RDD"></a>创建Pair RDD</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rdd2 = rdd1.flatMap(lambda line: line.split(&quot; &quot;))</span><br><span class="line">#转换数据结构 word =&gt; (word, 1)</span><br><span class="line">rdd3 = rdd2.map(lambda word: (word, 1)).persist()</span><br><span class="line">rdd3 = rdd2.map(lambda word: (word, 1)).cache()</span><br><span class="line">#将转换结构后的数据按照相同的单词进行分组聚合</span><br><span class="line">rdd4 = rdd3.reduceByKey(lambda a, b: a + b)</span><br></pre></td></tr></table></figure>

<h2 id="并行度调优"><a href="#并行度调优" class="headerlink" title="并行度调优"></a>并行度调优</h2><p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717941496383.png" alt="1717941496383"></p>
<p><img src="/../../source/images/rdd%E7%AC%94%E8%AE%B0/1717943653835.png" alt="1717943653835"></p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/%E7%88%AC%E8%99%AB/1-%E5%9F%BA%E7%A1%80/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  1-基础
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/python/python/">
			  
			
				  <!-- 在这里访问 page.next.slug -->
				  python/python
				
				<i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>






	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">lucky</a>
	
	
	
	<br>
	Email:wuliurong2021nnnu@163.com
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>