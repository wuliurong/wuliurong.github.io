<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		rdd使用 | 
	 
	hi
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

	
	

<meta name="generator" content="Hexo 7.0.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">hi</a>

	<ul id="menu">
    

    

    

    
      
      
        <li class="menu-item">
          <a href='' class="menu-item-link" target="_blank">
            
          </a>
        </li>
      
    
  
    
      <li class="menu-item">
        <a href='https://github.com/wuliurong' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Spark
									</a>
									
							<ul>
								<li class="file">
									<a href="/Spark/1-spark%E8%BD%AF%E4%BB%B6%E6%A0%88/">
                     
										    1-spark软件栈
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/centos%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    centos搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/Spark/rdd%E4%BD%BF%E7%94%A8/">
                     
										    rdd使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E7%AC%94%E8%AE%B0/">
                     
										    rdd笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/scala%E5%9F%BA%E7%A1%80/">
                     
										    scala基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/spark%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    spark学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/spark%E6%BA%90%E7%A0%81%E5%9F%BA%E7%A1%80/">
                     
										    spark源码基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/windows%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    windows搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E4%BD%BF%E7%94%A8IDEA%E5%9C%A8Maven%E4%B8%AD%E5%88%9B%E5%BB%BAjava%E5%92%8Cscala%E9%A1%B9%E7%9B%AE/">
                     
										    使用IDEA在Maven中创建java和scala项目
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0%E4%B8%8E%E5%AE%9E%E9%AA%8C/">
                     
										    课堂笔记与实验
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										hadoop
									</a>
									
							<ul>
								<li class="file">
									<a href="/hadoop/0.%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/">
                     
										    0.基本配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/1.Hadoop%E6%90%AD%E5%BB%BA%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%A8%A1%E5%BC%8F%E7%8E%AF%E5%A2%83/">
                     
										    1.Hadoop搭建伪分布式模式环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/10.%E8%BF%90%E8%90%A5%E5%95%86%E5%85%B3%E4%BA%8E%E7%94%A8%E6%88%B7%E5%9F%BA%E7%AB%99%E5%81%9C%E7%95%99%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/">
                     
										    10.运营商关于用户基站停留数据统计
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/11.Sqoop%E5%BA%94%E7%94%A8/">
                     
										    11.Sqoop应用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/2.%E9%80%9A%E8%BF%87shell%E5%91%BD%E4%BB%A4%E8%AE%BF%E9%97%AEHDFS/">
                     
										    2.通过shell命令访问HDFS
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/3.%E9%80%9A%E8%BF%87API%E8%AE%BF%E9%97%AEHDFS/">
                     
										    3.通过API访问HDFS
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/4.%E5%88%86%E6%9E%90%E7%BC%96%E5%86%99WordCount%E7%A8%8B%E5%BA%8F/">
                     
										    4.分析编写WordCount程序
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/5.Mapreduce%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%88%86%E5%8C%BA/">
                     
										    5.Mapreduce序列化和分区
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/6.MapReduce%E5%AE%9E%E9%AA%8Csales/">
                     
										    6.MapReduce实验sales
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/7.hive%E5%AE%9E%E9%AA%8C/">
                     
										    7.hive实验
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/8.%E6%90%9C%E7%8B%97%E6%97%A5%E5%BF%97%E6%9F%A5%E8%AF%A2%E5%88%86%E6%9E%90MapReduce+hive/">
                     
										    8.搜狗日志查询分析MapReduce+hive
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/9.%E5%9F%BA%E4%BA%8EHBase%E7%9A%84MapReduce%E8%AE%A1%E7%AE%97/">
                     
										    9.基于HBase的MapReduce计算
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/hadoop%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    hadoop学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                     
										    学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AE%9E%E9%AA%8C-%E5%9F%BA%E4%BA%8Ehadoop%E4%BA%92%E8%81%94%E7%BD%91%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%98/">
                     
										    实验-基于hadoop互联网日志分析实战
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/hadoop/%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95/">
                     
										    实验记录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										java
									</a>
									
							<ul>
								<li class="file">
									<a href="/java/linux/">
                     
										    linux
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										linux
									</a>
									
							<ul>
								<li class="file">
									<a href="/linux/%E5%9F%BA%E7%A1%80/">
                     
										    基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										python
									</a>
									
							<ul>
								<li class="file">
									<a href="/python/1-%E5%9F%BA%E7%A1%80/">
                     
										    1-基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/2-%E7%AC%94%E8%AE%B0/">
                     
										    2-笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/3-%E6%8A%A5%E9%94%99/">
                     
										    3-报错
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/4.%E5%AE%9E%E8%B7%B5/">
                     
										    4.实践
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/lambda/">
                     
										    lambda
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/python/">
                     
										    python
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E4%BD%9C%E4%B8%9A-pyechart/">
                     
										    作业-pyechart
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E4%BD%9C%E4%B8%9A-%E5%BD%93%E5%BD%93%E7%BD%91%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%A6%E7%B1%8D%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E4%B8%8E%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90/">
                     
										    作业-当当网计算机书籍数据挖掘与可视化分析
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/">
                     
										    模拟登录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2/">
                     
										    爬取动态页面
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										tableau
									</a>
									
							<ul>
								<li class="file">
									<a href="/tableau/%E4%BD%9C%E4%B8%9A-tableau/">
                     
										    作业-tableau
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E4%BB%AA%E8%A1%A8%E6%9D%BF/">
                     
										    课件-tableau仪表板
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E5%85%A5%E9%97%A8/">
                     
										    课件-tableau入门
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E7%BB%83%E4%B9%A0/">
                     
										    课件-tableau练习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										其他笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/docker/">
                     
										    docker
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/vscode/">
                     
										    vscode
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E5%9F%BA%E7%A1%80/">
                     
										    基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E9%95%9C%E5%83%8F%E6%BA%90/">
                     
										    镜像源
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%9C%A8%E6%A0%A1%E7%BB%8F%E5%8E%86/">
                     
										    在校经历
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										报错
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/Hyper-V/">
                     
										    Hyper-V
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/github%E5%9F%BA%E7%A1%80%E8%AF%AD%E5%8F%A5/">
                     
										    github基础语句
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-deploy/">
                     
										    hexo-deploy
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-typora-img/">
                     
										    hexo-typora-img
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/linux%E8%BF%9E%E4%B8%8D%E4%B8%8A%E7%BD%91/">
                     
										    linux连不上网
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/vscode-install-config/">
                     
										    vscode-install-config
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										数仓学习
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%95%B0%E4%BB%93%E5%AD%A6%E4%B9%A0/%E7%A6%BB%E7%BA%BF%E5%AE%9E%E6%97%B6%E6%95%B0%E4%BB%93%E6%A6%82%E8%AE%BA/">
                     
										    离线实时数仓概论
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										日记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2022-12-24/">
                     
										    2022-12-24
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-13/">
                     
										    2024-1-13
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-17/">
                     
										    2024-1-17
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-19/">
                     
										    2024-1-19
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-2-15/">
                     
										    2024-2-15
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										科研经历
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E7%A7%91%E7%A0%94%E7%BB%8F%E5%8E%86/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A0%B7%E6%9C%AC%E9%97%AE%E9%A2%98/">
                     
										    深度学习图像分类中的对抗样本问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	rdd使用
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>lucky</span>
	<span>2024-06-09 17:16:13</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717553140438.png" alt="1717553140438"></p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717571643750.png" alt="1717571643750"></p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717571703168.png" alt="1717571703168"></p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717571711894.png" alt="1717571711894"></p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717571717654.png" alt="1717571717654"></p>
<h1 id="转换算子"><a href="#转换算子" class="headerlink" title="转换算子"></a>转换算子</h1><h3 id="parallelize转化为RDD"><a href="#parallelize转化为RDD" class="headerlink" title="parallelize转化为RDD"></a>parallelize转化为RDD</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdd = sc.parallelize(data)</span><br></pre></td></tr></table></figure>

<p><code>parallelize</code>方法将本地数据集转换为RDD。这意味着数据将被分布式存储和处理，以便进行并行计算。</p>
<h3 id="indspark自动初始化"><a href="#indspark自动初始化" class="headerlink" title="indspark自动初始化"></a>indspark自动初始化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import findspark</span><br><span class="line">findspark.init()</span><br><span class="line">from pyspark import SparkContext</span><br><span class="line">sc = SparkContext(&quot;local&quot;, &quot;causal&quot;)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>findspark.init()</code>：这行代码用于自动查找并初始化Spark环境。它会设置环境变量，使得你的Python解释器能够找到Spark。</li>
</ul>
<p><code>import findspark</code>：这行代码导入了findspark库，该库可以帮助在Python环境中找到并初始化Spark。</p>
<p><code>findspark.init()</code>：这行代码调用了findspark库中的init()函数，用于初始化Spark环境。它会查找Spark安装的路径并将其添加到Python解释器的sys.path中，以便Python可以找到Spark。</p>
<p><code>from pyspark import SparkContext</code>：这行代码从pyspark库中导入了SparkContext类，用于创建一个SparkContext对象。</p>
<p><code>sc = SparkContext(&quot;local&quot;, &quot;causal&quot;)</code>：这行代码创建了一个本地模式的SparkContext对象，参数”local”表示使用本地模式，”causal”是Spark应用程序的名称。</p>
<h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a>flatMap</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717554083439.png" alt="1717554083439"></p>
<h3 id="mapPartitions"><a href="#mapPartitions" class="headerlink" title="mapPartitions"></a>mapPartitions</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717556145626.png" alt="1717556145626"></p>
<ol>
<li><code>rdd = sc.parallelize([1, 2, 3, 4], 2)</code>：这行代码创建了一个包含数字 1, 2, 3, 4 的RDD，并将其分成两个分区（partitions）。<code>sc</code> 是SparkContext对象，通过它可以创建RDD。<code>parallelize</code> 方法将一个Python列表转换为RDD，并指定了分区数为2，即将列表中的元素分为两个部分。</li>
<li><code>def f(iterator): yield sum(iterator)</code>：这是一个定义函数的语句，函数名为 <code>f</code>。这个函数接收一个迭代器（iterator）作为参数，对迭代器中的元素进行求和操作，并使用 <code>yield</code> 语句生成求和结果。<code>yield</code> 语句用于生成一个迭代器的元素，类似于 <code>return</code> 但不会终止函数的执行。</li>
<li><code>rdd.mapPartitions(f)</code>：这一步对RDD中的每个分区应用函数 <code>f</code>，即对每个分区中的元素进行求和操作。<code>mapPartitions</code> 是一个转换操作（Transformation），它可以对RDD中的每个分区应用一个函数，生成一个新的RDD。</li>
<li><code>res = rdd.mapPartitions(f).collect()</code>：最后，<code>collect</code> 是一个动作操作（Action），它将RDD中的元素收集到驱动程序中，并以Python列表的形式返回结果。在这里，将每个分区求和的结果收集到列表 <code>res</code> 中。</li>
</ol>
<p> 普通话分区服从均匀分布，可手动指定分区方式<code>partitionBy</code> 是Spark中用于手动指定RDD分区方式的方法，通常用于对PairRDD进行分区 </p>
<h3 id="mapPartitionWithIndex"><a href="#mapPartitionWithIndex" class="headerlink" title="mapPartitionWithIndex"></a>mapPartitionWithIndex</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717556361101.png" alt="1717556361101"></p>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdd = sc.parallelize([1, 2, 3, 4, 5])res = rdd.filter(lambda x: x % 2 == 0).collect()</span><br></pre></td></tr></table></figure>

<h3 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdd = sc.parallelize([1, 1, 2, 3])res = rdd.distinct().collect()</span><br></pre></td></tr></table></figure>

<h3 id="union不去重"><a href="#union不去重" class="headerlink" title="union不去重"></a>union不去重</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdd1= sc.parallelize([1,2,3])rdd2= sc.parallelize([4,5,6])res = rdd1.union(rdd2).collect()</span><br></pre></td></tr></table></figure>

<h3 id="intersection去重"><a href="#intersection去重" class="headerlink" title="intersection去重"></a>intersection去重</h3><h3 id="subtract"><a href="#subtract" class="headerlink" title="subtract"></a>subtract</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">res = rdd1.subtract(rdd2).collect()</span><br><span class="line">rdd1 - rdd2</span><br></pre></td></tr></table></figure>



<h2 id="pairRDD-K-V"><a href="#pairRDD-K-V" class="headerlink" title="pairRDD&#x3D;K-V"></a>pairRDD&#x3D;K-V</h2><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717556836526.png" alt="1717556836526"></p>
<h3 id="sortByKey"><a href="#sortByKey" class="headerlink" title="sortByKey"></a>sortByKey</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">res = sc.parallelize(tmp).sortByKey().collect()</span><br><span class="line"></span><br><span class="line">rdd.sortByKey(ascending=True, numPartitions=None, keyfunc = lambda x: str(x))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717556963750.png" alt="1717556963750"></p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717557001202.png" alt="1717557001202"></p>
<h3 id="mapValues"><a href="#mapValues" class="headerlink" title="mapValues"></a>mapValues</h3><p>对pair RDD 中的每个值应用一个函数而不改变键</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717557047439.png" alt="1717557047439"></p>
<h3 id="flatMapValues"><a href="#flatMapValues" class="headerlink" title="flatMapValues"></a>flatMapValues</h3><p> 是对集合中的每个键值对的值（value）应用一个函数，然后将结果扁平化成新的键值对集合。 </p>
<h3 id="groupBykey"><a href="#groupBykey" class="headerlink" title="groupBykey"></a>groupBykey</h3><p>对具有相同键的值进行分组</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717557204262.png" alt="1717557204262"></p>
<h3 id="reduceBykey"><a href="#reduceBykey" class="headerlink" title="reduceBykey"></a>reduceBykey</h3><p>合并具有相同键的值</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717557243395.png" alt="1717557243395"></p>
<h3 id="countByValue"><a href="#countByValue" class="headerlink" title="countByValue"></a>countByValue</h3><p>可以让用户返回与输入数据的类型不同的返回值</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717940544895.png" alt="1717940544895"></p>
<h3 id="combineByKey"><a href="#combineByKey" class="headerlink" title="combineByKey"></a>combineByKey</h3><p> 有多个参数分别对应聚合操作的各个阶段，因而非常适合用来解释聚合操作各个阶段的功能划分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sum_count_rdd = rdd.combineByKey(    </span><br><span class="line"># 初始值的创建函数，对于新的键，创建一个元组 (value, 1)，其中value是成绩，1是计数器初始值    </span><br><span class="line">lambda value: (value, 1),    </span><br><span class="line"># 对现有键进行值的累加操作，将新的值加到累加器中    </span><br><span class="line">lambda acc, value: (acc[0] + value, acc[1] + 1),    </span><br><span class="line"># 合并累加器的函数，将两个累加器的值相加，计数器相加    </span><br><span class="line">lambda acc1, acc2: (acc1[0] + acc2[0], acc1[1] + acc2[1]) ) </span><br><span class="line"># 计算每个学生的平均成绩 </span><br><span class="line">average_scores = sum_count_rdd.mapValues(lambda x: x[0] / x[1]) </span><br></pre></td></tr></table></figure>

<img src="../../source/images/rdd使用/1717941265450.png" alt="1717941265450" style="zoom:80%;">



<h3 id="subtractByKey"><a href="#subtractByKey" class="headerlink" title="subtractByKey"></a>subtractByKey</h3><p>删掉 RDD 中键与 other RDD 中的键相同的元素</p>
<h3 id="keys-values"><a href="#keys-values" class="headerlink" title=".keys()      .values()"></a>.keys()      .values()</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717557332668.png" alt="1717557332668"></p>
<h3 id="join"><a href="#join" class="headerlink" title="join"></a>join</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717558525799.png" alt="1717558525799"></p>
<h3 id="leftJoin"><a href="#leftJoin" class="headerlink" title="leftJoin"></a>leftJoin</h3><h3 id="rightJoin"><a href="#rightJoin" class="headerlink" title="rightJoin"></a>rightJoin</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717558532291.png" alt="1717558532291"></p>
<h3 id="rightOuterJoin"><a href="#rightOuterJoin" class="headerlink" title="rightOuterJoin"></a>rightOuterJoin</h3><p>针对两个pair RDD的转化操作（rdd &#x3D; {(1, 2), (3, 4), (3, 6)}other &#x3D; {(3, 9)}）</p>
<p>对两个 RDD 进行内连接<br>rdd.join(other)</p>
<p>{(3, (4, 9)), (3, (6, 9))}</p>
<p>rightOuterJoin<br>对两个 RDD 进行连接操作，确保第一个 RDD 的键必须存在（右外连接）<br>rdd.rightOuterJoin(other)<br>{(3,(Some(4),9)), (3,(Some(6),9))}</p>
<h3 id="leftOuterJoin"><a href="#leftOuterJoin" class="headerlink" title="leftOuterJoin"></a>leftOuterJoin</h3><p>对两个 RDD 进行连接操作，确保第二个 RDD 的键必须存在（左外连接）<br>rdd.leftOuterJoin(other)<br>{(1,(2,None)), (3, (4,Some(9))), (3, (6,Some(9)))}</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717941877402.png" alt="1717941877402"></p>
<h3 id="cogroup"><a href="#cogroup" class="headerlink" title="cogroup"></a>cogroup</h3><p>将两个 RDD 中拥有相同键的数据分组到一起<br>rdd.cogroup(other)<br>{(1,([2],[])), (3, ([4, 6],[9]))}</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717941661770.png" alt="1717941661770"></p>
<h3 id="aggregateByKey"><a href="#aggregateByKey" class="headerlink" title="aggregateByKey"></a>aggregateByKey</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717570782529.png" alt="1717570782529"></p>
<h1 id="执行算子"><a href="#执行算子" class="headerlink" title="执行算子"></a>执行算子</h1><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717571781347.png" alt="1717571781347"></p>
<h3 id="collect"><a href="#collect" class="headerlink" title="collect"></a>collect</h3><p>返回RDD中所有元素</p>
<p>sc.parallelize([1 , 2 , 3 , 4]).collect()<br>结果： [1 , 2 , 3 , 4]</p>
<p> <code>collect</code> 是Spark中的一个动作（Action），它用于将RDD中的所有元素收集到驱动程序（Driver Program）所在的节点上，并以Python列表的形式返回。换句话说，<code>collect</code> 将RDD中的分布式数据集合并到一个本地的Python列表中。 </p>
<h3 id="count"><a href="#count" class="headerlink" title="count"></a>count</h3><p>返回元素个数</p>
<p>sc.parallelize([1 , 2 , 3 , 4]).count()<br>结果： 4</p>
<h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h3><p>通过指定方法对RDD中的元素进行聚合（累加）</p>
<p>sc.parallelize([1, 2, 3, 4, 5]).reduce(lambda a,b:a+b)   #求和</p>
<h3 id="take"><a href="#take" class="headerlink" title="take"></a>take</h3><p>返回RDD中的前几个元素，若指定数量大于元素个数，则功能与collect相同</p>
<p>sc.parallelize([1, 2, 3, 4, 5]).take(3)<br>结果：[1,2,3]</p>
<p>5、takeOrdered：排序后再take</p>
<p>sc.parallelize([4, 6, 8, 2, 9]).takeOrdered(3)<br>结果：[2, 4, 6]</p>
<h3 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h3><p>遍历所有元素，让所有元素都执行一个函数，没有返回值</p>
<p>def f(x): print(x)sc.parallelize([1, 2, 3, 4, 5]).foreach(f)</p>
<p> <code>foreach</code> 是Spark中的一个动作（Action），用于对RDD中的每个元素执行指定的操作。在你提供的代码中，<code>rdd4.foreach(print)</code> 的意思是对RDD <code>rdd4</code> 中的每个元素执行 <code>print</code> 操作，即打印每个元素的值。 </p>
<h3 id="foreachPartiton"><a href="#foreachPartiton" class="headerlink" title="foreachPartiton"></a>foreachPartiton</h3><p>对每个分区进行遍历，没有返回值</p>
<p>def f(iterator):<br>    s&#x3D;sum(iterator)<br>    print(s)<br>sc.parallelize([1, 2, 3, 4, 5],3).foreachPartition(f)</p>
<h3 id="保存saveAsTextFile"><a href="#保存saveAsTextFile" class="headerlink" title="保存saveAsTextFile"></a>保存saveAsTextFile</h3><p>将RDD中的元素以字符串的格式存储在文件系统中。注意只能指定文件夹名，文件名会自动生成<br>rdd &#x3D; sc.parallelize([1,2,3,4],2)<br>#存到本地<br>rdd.saveAsTextFile(‘&#x2F;home&#x2F;ubuntu&#x2F;result’)<br>#存到HDFS<br>rdd.saveAsTextFile(‘hdfs:&#x2F;&#x2F;xdata-m0:8020&#x2F;user&#x2F;ua15&#x2F;spark-data’)</p>
<p>即&#x2F;home&#x2F;ubuntu&#x2F;为本机实际存在的文件，result是指定创建的文件的名字。其中文件中的多个文本文件保存者数据</p>
<h2 id="pairRDD-K-V-1"><a href="#pairRDD-K-V-1" class="headerlink" title="pairRDD&#x3D;K-V"></a>pairRDD&#x3D;K-V</h2><p>（以键值对集合{(1, 2), (3, 4), (3, 6)}为例）</p>
<h3 id="collectAsMap"><a href="#collectAsMap" class="headerlink" title="collectAsMap"></a>collectAsMap</h3><p>以字典形式，返回PairRDD中的键值对，如果key重复，则后面的value覆盖前面的</p>
<p>将结果以映射表的形式返回，以便查询</p>
<p>rdd.collectAsMap()<br>Map{(1, 2), (3, 4), (3, 6)}</p>
<h3 id="countByKey"><a href="#countByKey" class="headerlink" title="countByKey"></a>countByKey</h3><p>对每个键对应的元素分别计数</p>
<p>以字典形式，返回PairRDD中key值出现的次数<br>rdd.countByKey()<br>{(1, 1), (3, 2)}</p>
<h3 id="lookup"><a href="#lookup" class="headerlink" title="lookup"></a>lookup</h3><p>返回给定键对应的所有值</p>
<p>rdd.lookup(3)<br>[4, 6]</p>
<h1 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h1><p>rdd.mapValues(lambda x: (x, 1)).reduceByKey(lambda x, y: (x[0] + y[0], x[1] + y[1]))</p>
<img src="../../source/images/rdd使用/1717940026355.png" alt="1717940026355" style="zoom:80%;">

<p>result &#x3D; words.map(lambda x: (x, 1)).reduceByKey(lambda x, y: x + y)</p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717940401043.png" alt="1717940401043"></p>
<h1 id="数据分区"><a href="#数据分区" class="headerlink" title="数据分区"></a>数据分区</h1><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717942670211.png" alt="1717942670211"></p>
<h2 id="partitionBy"><a href="#partitionBy" class="headerlink" title="partitionBy"></a>partitionBy</h2><p>是一个转化操作，因此它的返回值总是一个新的RDD，但它不会改变原来的 RDD。RDD 一旦创建就无法修改。因此应该对 partitionBy()的结果进行持久化。</p>
<p>不进行持久化会导致整个 RDD 谱系图重新求值。那样的话，partitionBy()带来的好处就会被抵消，导致重复对数据进行分区以及跨节点的混洗，和没有指定分区方式时发生的情况十分相似。</p>
<img src="../../source/images/rdd使用/1717943046465.png" alt="1717943046465" style="zoom:67%;">

<h2 id="分区方式"><a href="#分区方式" class="headerlink" title="分区方式"></a>分区方式</h2><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717943215928.png" alt="1717943215928"></p>
<p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717944377030.png" alt="1717944377030"></p>
<h2 id="分区获益"><a href="#分区获益" class="headerlink" title="分区获益"></a>分区获益</h2><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717943436706.png" alt="1717943436706"></p>
<h3 id="PageRank"><a href="#PageRank" class="headerlink" title="PageRank"></a>PageRank</h3><p><img src="/../../source/images/rdd%E4%BD%BF%E7%94%A8/1717944436391.png" alt="1717944436391"></p>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/python/python/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  python
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/python/%E4%BD%9C%E4%B8%9A-pyechart/">
			  
			
				  <!-- 在这里访问 page.next.slug -->
				  python/作业-pyechart
				
				<i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>






	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">lucky</a>
	
	
	
	<br>
	Email:wuliurong2021nnnu@163.com
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>