<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		作业-scrapy+mysql+kettle+flask+tableau+数据挖掘+navicat | 
	 
	hi
	</title>
	
	<!-- keywords,description -->
	
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>


	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

	
	

<meta name="generator" content="Hexo 7.0.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">hi</a>

	<ul id="menu">
    

    

    

    
      
      
        <li class="menu-item">
          <a href='' class="menu-item-link" target="_blank">
            
          </a>
        </li>
      
    
  
    
      <li class="menu-item">
        <a href='https://github.com/wuliurong' class="menu-item-link" target="_blank">
          <i class="fa fa-github fa-2x"></i>
        </a>
      </li>
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Docker
									</a>
									
							<ul>
								<li class="file">
									<a href="/Docker/%E9%97%AE%E9%A2%98/">
                     
										    问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Spark
									</a>
									
							<ul>
								<li class="file">
									<a href="/Spark/1-spark%E8%BD%AF%E4%BB%B6%E6%A0%88/">
                     
										    1-spark软件栈
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/centos%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    centos搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E4%BD%BF%E7%94%A8/">
                     
										    rdd使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/rdd%E7%AC%94%E8%AE%B0/">
                     
										    rdd笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/Spark/windows%E6%90%AD%E5%BB%BApyspark%E7%8E%AF%E5%A2%83/">
                     
										    windows搭建pyspark环境
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										python
									</a>
									
							<ul>
								<li class="file">
									<a href="/python/lambda/">
                     
										    lambda
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/python/python/">
                     
										    python
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										tableau
									</a>
									
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E4%BB%AA%E8%A1%A8%E6%9D%BF/">
                     
										    课件-tableau仪表板
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E5%85%A5%E9%97%A8/">
                     
										    课件-tableau入门
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/tableau/%E8%AF%BE%E4%BB%B6-tableau%E7%BB%83%E4%B9%A0/">
                     
										    课件-tableau练习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E4%BD%9C%E4%B8%9A-pyechart/">
                     
										    作业-pyechart
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/">
                     
										    作业-scrapy+mysql+kettle+flask+tableau+数据挖掘+navicat
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E4%BD%9C%E4%B8%9A-tableau/">
                     
										    作业-tableau
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										其他笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/vscode/">
                     
										    vscode
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8Btcpip/">
                     
										    网络编程tcpip
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										报错
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/github%E5%9F%BA%E7%A1%80%E8%AF%AD%E5%8F%A5/">
                     
										    github基础语句
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-deploy/">
                     
										    hexo-deploy
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/hexo-typora-img/">
                     
										    hexo-typora-img
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%8A%A5%E9%94%99/vscode-install-config/">
                     
										    vscode-install-config
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										日记
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-13/">
                     
										    2024-1-13
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-17/">
                     
										    2024-1-17
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-1-19/">
                     
										    2024-1-19
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E6%97%A5%E8%AE%B0/2024-2-15/">
                     
										    2024-2-15
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										爬虫
									</a>
									
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/1-%E5%9F%BA%E7%A1%80/">
                     
										    1-基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/2-%E7%AC%94%E8%AE%B0/">
                     
										    2-笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/3-%E6%8A%A5%E9%94%99/">
                     
										    3-报错
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/4.%E5%AE%9E%E8%B7%B5/">
                     
										    4.实践
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/">
                     
										    模拟登录
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/%E7%88%AC%E8%99%AB/%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2/">
                     
										    爬取动态页面
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content" class="content">
		<h1 id="article-title">
	作业-scrapy+mysql+kettle+flask+tableau+数据挖掘+navicat
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>lucky</span>
	<span>2024-06-12 20:54:30</span>

  <div id="article-categories">
    
		  <span>Categories：</span>
      
    

    
		    <span>Tags：</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<p>期末作业：当当网计算机书籍数据挖掘</p>
<h1 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">思路：</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">备注</span><br><span class="line">1.在scrapy爬取数据的时候就可以过滤掉不想要的数据，应作业要求使用kettle清洗数据</span><br><span class="line">2.当当网page只能到100页，单页五十多本书，尽管相关商品有二十万，最多只能爬下来五千多条数据</span><br><span class="line">3.critic字段，当书籍是当当网自营的时候，爬取的数据是评论条数，非自营显示的是书店名称。无店名即是自营</span><br><span class="line">4.</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; domain = [&#x27;product.dangdang.com&#x27;]</span><br><span class="line">&gt;&gt;&gt; le = LinkExtractor(allow_domains = domain) </span><br><span class="line">&gt;&gt;&gt; le.extract_links(response) </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy crawl Dd -v 2，这样可以显示更详细的日志信息</span><br></pre></td></tr></table></figure>



<h1 id="scrapy"><a href="#scrapy" class="headerlink" title="scrapy"></a>scrapy</h1><p>编写spider</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ..items <span class="keyword">import</span> DangdangItem<span class="comment">#注意这里，经常容易报错</span></span><br><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DdSpider</span>(scrapy.Spider):</span><br><span class="line">    name = <span class="string">&quot;Dd&quot;</span></span><br><span class="line">    allowed_domains = [<span class="string">&quot;search.dangdang.com&quot;</span>]</span><br><span class="line">    start_urls = [<span class="string">&#x27;http://search.dangdang.com/?key=%BC%C6%CB%E3%BB%FA&amp;act=input&amp;page_index=1&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">self, response</span>):</span><br><span class="line">        li_lists = response.xpath(<span class="string">&#x27;//*[@id=&quot;component_59&quot;]/li&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> li_list <span class="keyword">in</span> li_lists:</span><br><span class="line">            item = DangdangItem()</span><br><span class="line">            title = li_list.xpath(<span class="string">&#x27;./a/@title&#x27;</span>).extract_first()</span><br><span class="line">            link = <span class="string">&#x27;http:&#x27;</span> + li_list.xpath(<span class="string">&#x27;./p[1]/a/@href&#x27;</span>).extract_first()</span><br><span class="line">            price = li_list.xpath(<span class="string">&#x27;./p[3]/span/text()&#x27;</span>).extract_first()</span><br><span class="line">            pre_price = li_list.xpath(<span class="string">&#x27;./p[3]/span[2]/text()&#x27;</span>).extract_first()</span><br><span class="line">            critic = li_list.xpath(<span class="string">&#x27;./p[4]/a/text()&#x27;</span>).extract_first()</span><br><span class="line">            author = li_list.xpath(<span class="string">&#x27;./p[5]/span[1]/a/text()&#x27;</span>).extract_first()</span><br><span class="line">            public = li_list.xpath(<span class="string">&#x27;./p[5]/span[3]/a/text()&#x27;</span>).extract_first()</span><br><span class="line">            time = li_list.xpath(<span class="string">&#x27;./p[5]/span[2]/text()&#x27;</span>).extract_first()</span><br><span class="line"></span><br><span class="line">            item[<span class="string">&#x27;title&#x27;</span>] = title</span><br><span class="line">            item[<span class="string">&#x27;link&#x27;</span>] = link</span><br><span class="line">            item[<span class="string">&#x27;price&#x27;</span>] = price</span><br><span class="line">            item[<span class="string">&#x27;pre_price&#x27;</span>] = pre_price</span><br><span class="line">            item[<span class="string">&#x27;critic&#x27;</span>] = critic</span><br><span class="line">            item[<span class="string">&#x27;author&#x27;</span>] = author</span><br><span class="line">            item[<span class="string">&#x27;public&#x27;</span>] = public</span><br><span class="line">            item[<span class="string">&#x27;time&#x27;</span>] = time</span><br><span class="line">            <span class="keyword">yield</span> item</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">100</span>):<span class="comment">#爬取多页</span></span><br><span class="line">            url = <span class="string">f&#x27;http://search.dangdang.com/?key=%BC%C6%CB%E3%BB%FA&amp;act=input&amp;page_index=<span class="subst">&#123;page&#125;</span>&#x27;</span></span><br><span class="line">            result = scrapy.Request(url, callback=self.parse)</span><br><span class="line">            <span class="keyword">yield</span> result</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>items.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DangdangItem</span>(scrapy.Item):</span><br><span class="line">    title = scrapy.Field()</span><br><span class="line">    link = scrapy.Field()</span><br><span class="line">    price = scrapy.Field()</span><br><span class="line">    pre_price = scrapy.Field()</span><br><span class="line">    critic = scrapy.Field()</span><br><span class="line">    author = scrapy.Field()</span><br><span class="line">    public = scrapy.Field()</span><br><span class="line">    time = scrapy.Field()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>piplines.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#类名添加进settings.py中</span></span><br><span class="line"><span class="comment">#连接mysql数据库</span></span><br><span class="line"><span class="comment">#也可以在这里编写类处理数据</span></span><br></pre></td></tr></table></figure>

<p>settings.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">   <span class="string">&#x27;Dangdang.pipelines.DangdangPipeline&#x27;</span>: <span class="number">300</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pipelines.py，将类名添加进settings.py</span></span><br><span class="line"><span class="keyword">import</span> mysql.connector  <span class="comment">#（报错过）</span></span><br><span class="line"><span class="keyword">from</span> scrapy.exceptions <span class="keyword">import</span> DropItem</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DangdangPipeline</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    DB_HOST = <span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">    DB_USER = <span class="string">&#x27;root&#x27;</span></span><br><span class="line">    DB_PASSWORD = <span class="string">&#x27;123456&#x27;</span></span><br><span class="line">    DB_NAME = <span class="string">&#x27;bitest&#x27;</span></span><br><span class="line">    charset = <span class="string">&#x27;utf8mb4&#x27;</span>  <span class="comment"># 指定字符集(报错过)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">open_spider</span>(<span class="params">self, spider</span>):</span><br><span class="line">        self.conn = mysql.connector.connect(</span><br><span class="line">            host=self.DB_HOST,</span><br><span class="line">            user=self.DB_USER,</span><br><span class="line">            password=self.DB_PASSWORD,</span><br><span class="line">            database=self.DB_NAME</span><br><span class="line">        )</span><br><span class="line">        self.cursor = self.conn.cursor()</span><br><span class="line">        self.create_table()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_table</span>(<span class="params">self</span>):</span><br><span class="line">        create_table_query = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        CREATE TABLE IF NOT EXISTS python_spider (</span></span><br><span class="line"><span class="string">            id INT AUTO_INCREMENT PRIMARY KEY,</span></span><br><span class="line"><span class="string">            title VARCHAR(255),</span></span><br><span class="line"><span class="string">            link VARCHAR(255) ,</span></span><br><span class="line"><span class="string">            price VARCHAR(255) ,</span></span><br><span class="line"><span class="string">            pre_price VARCHAR(255) ,</span></span><br><span class="line"><span class="string">            critic VARCHAR(255) ,</span></span><br><span class="line"><span class="string">            author VARCHAR(255) ,</span></span><br><span class="line"><span class="string">            public VARCHAR(255) ,</span></span><br><span class="line"><span class="string">            time VARCHAR(255) </span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        self.cursor.execute(create_table_query)</span><br><span class="line">        self.conn.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close_spider</span>(<span class="params">self, spider</span>):</span><br><span class="line">        self.cursor.close()</span><br><span class="line">        self.conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_item</span>(<span class="params">self, item, spider</span>):<span class="comment">#处理爬取的数据</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> item[<span class="string">&#x27;price&#x27;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                price = item[<span class="string">&#x27;price&#x27;</span>].replace(<span class="string">&#x27;¥&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                price = <span class="number">0.00</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> item[<span class="string">&#x27;pre_price&#x27;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                pre_price = item[<span class="string">&#x27;pre_price&#x27;</span>].replace(<span class="string">&#x27;¥&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pre_price = price</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> item[<span class="string">&#x27;time&#x27;</span>] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                time = item[<span class="string">&#x27;time&#x27;</span>].replace(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                time = <span class="string">&#x27;0000-00-00&#x27;</span></span><br><span class="line"></span><br><span class="line">            s = <span class="string">&quot;评论&quot;</span></span><br><span class="line">            critic = item[<span class="string">&#x27;critic&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> s <span class="keyword">in</span> critic:</span><br><span class="line">                critic = <span class="string">&quot;当当自营&quot;</span></span><br><span class="line"></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;title&#x27;</span>: item[<span class="string">&#x27;title&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;link&#x27;</span>: item[<span class="string">&#x27;link&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;price&#x27;</span>: price,</span><br><span class="line">                <span class="string">&#x27;pre_price&#x27;</span>: pre_price,</span><br><span class="line">                <span class="string">&#x27;critic&#x27;</span>: critic,</span><br><span class="line">                <span class="string">&#x27;author&#x27;</span>: item[<span class="string">&#x27;author&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;public&#x27;</span>: item[<span class="string">&#x27;public&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;time&#x27;</span>: time,</span><br><span class="line">            &#125;</span><br><span class="line">            self.insert_item(data)</span><br><span class="line">        <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:  <span class="comment">#float-&gt;string-&gt;不然kettle用不上</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;将价格转换为浮点数时出错: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">raise</span> DropItem(<span class="string">f&quot;无效的价格值: <span class="subst">&#123;item[<span class="string">&#x27;price&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert_item</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            insert_query = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            INSERT INTO python_spider (title, link, price, pre_price, critic, author, public, time)</span></span><br><span class="line"><span class="string">            VALUES (%s, %s, %s, %s, %s, %s, %s, %s)</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line">            self.cursor.execute(insert_query, (</span><br><span class="line">                item[<span class="string">&#x27;title&#x27;</span>], item[<span class="string">&#x27;link&#x27;</span>], item[<span class="string">&#x27;price&#x27;</span>], item[<span class="string">&#x27;pre_price&#x27;</span>],</span><br><span class="line">                item[<span class="string">&#x27;critic&#x27;</span>], item[<span class="string">&#x27;author&#x27;</span>], item[<span class="string">&#x27;public&#x27;</span>], item[<span class="string">&#x27;time&#x27;</span>]</span><br><span class="line">            ))</span><br><span class="line">            self.conn.commit()</span><br><span class="line">        <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;将项目插入数据库时出错: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            self.conn.rollback()<span class="comment">#回滚事务，撤销之前的操作，保持数据库的一致性</span></span><br><span class="line">            <span class="keyword">raise</span> DropItem(<span class="string">f&quot;插入项目到数据库失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>截图</p>
<p><img src="/../images/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/1718197126288.png" alt="1718197126288"></p>
<p><img src="/../images/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/1718267137783.png" alt="1718267137783"></p>
<p><img src="/../images/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/1718197179215.png" alt="1718197179215"></p>
<h1 id="kettle"><a href="#kettle" class="headerlink" title="kettle"></a>kettle</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.过滤空值的数据</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/1718267050555.png" alt="1718267050555"></p>
<p><img src="/../images/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/1718266928898.png" alt="1718266928898"></p>
<p><img src="/../images/%E4%BD%9C%E4%B8%9A-scrapy+mysql+kettle+flask+tableau+%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98+navicat/1718267088261.png" alt="1718267088261"></p>
<h1 id="tableau"><a href="#tableau" class="headerlink" title="tableau"></a>tableau</h1><h1 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h1><h1 id="数据挖掘"><a href="#数据挖掘" class="headerlink" title="数据挖掘"></a>数据挖掘</h1><h1 id="navicat"><a href="#navicat" class="headerlink" title="navicat"></a>navicat</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#无限试用方法</span><br><span class="line">#创建nave.txt写入该代码修改文件名nave.bat并运行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">echo Delete HKEY_CURRENT_USER\Software\PremiumSoft\NavicatPremium\Registration[version and language]</span><br><span class="line">for /f %%i in (&#x27;&quot;REG QUERY &quot;HKEY_CURRENT_USER\Software\PremiumSoft\NavicatPremium&quot; /s | findstr /L Registration&quot;&#x27;) do (</span><br><span class="line">    reg delete %%i /va /f</span><br><span class="line">)</span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo Delete Info folder under HKEY_CURRENT_USER\Software\Classes\CLSID</span><br><span class="line">for /f %%i in (&#x27;&quot;REG QUERY &quot;HKEY_CURRENT_USER\Software\Classes\CLSID&quot; /s | findstr /E Info&quot;&#x27;) do (</span><br><span class="line">    reg delete %%i /va /f</span><br><span class="line">)</span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo Finish</span><br><span class="line"></span><br><span class="line">pause</span><br></pre></td></tr></table></figure>


</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/%E4%BD%9C%E4%B8%9A-tableau/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  作业-tableau
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/%E7%88%AC%E8%99%AB/%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2/">
			  
			
				  <!-- 在这里访问 page.next.slug -->
				  爬虫/爬取动态页面
				
				<i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>






	</div>
	<div id="footer">
	<p>
	©<span id="footerYear-start"></span>-<span id="footerYear-end"></span>

	
	    <a href="/">lucky</a>
	
	
	
	<br>
	Email:wuliurong2021nnnu@163.com
	</p>
</div>


<script type="text/javascript">
	document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
</script>

<script type="text/javascript">
	document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
</script>

	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>